function closeOnEscape(t){$(window).one("keyup",function(e){"27"===e.keyCode&&t.w.jqmHide()})}function readCookie(t){for(var e=t+"=",n=document.cookie.split(";"),o=0;o<n.length;o++){for(var r=n[o];" "===r.charAt(0);)r=r.substring(1,r.length);if(0===r.indexOf(e))return r.substring(e.length,r.length)}return null}function inGroupsOf(t,e){return _.reduce(e,function(e,n){var o=e[e.length-1];return o.length<t?o.push(n):e.push([n]),e},[[]])}function expect_logged_in(){return"1"===readCookie("expect_signed_in")?!0:"0"===readCookie("expect_signed_in")?!1:!1}function update_user_clipped_document_count(){var t=parseInt($("#document-count #doc_count").html(),10);$("#document-count #doc_count").html(t+1)}function update_user_folder_count(){var t=parseInt($("#document-count-holder #user_folder_count").html(),10);$("#user_folder_count").html(t+1)}function update_user_folder_document_count(){var t=parseInt($("#document-count-holder #user_documents_in_folders_count").html(),10);$("#user_documents_in_folders_count").html(t+1)}function update_user_folder_and_document_count(t){update_user_folder_count(t),update_user_folder_document_count(t)}function document_number_present(t,e){return 0!==_.filter(e.folders,function(e){return $.inArray(t,e.documents)>-1}).length}function show_folder_success(t){var e=$("<p>").append('Successfully created folder "'+t.folder.name+'"').append($("<span>").addClass("icon-fr2 icon-fr2-badge_check_mark"));$("#new-folder-modal .folder_success p").replaceWith(e),$("#new-folder-modal .folder_success").show()}function set_clipped_icon_status(){$("#add-to-folder .menu li.in_folder").length>0?$("#add-to-folder .button .icon").addClass("clipped"):$("#add-to-folder .button .icon").removeClass("clipped")}function closeOnEscape(t){$(window).one("keyup",function(e){"27"===e.keyCode&&t.w.jqmHide()})}function get_user_state(){return expect_logged_in()?"logged_in":"logged_out"}function get_page_type(){return null===window.location.pathname.match(/\/search/)?"document":"search"}function get_folder_type(t){return"my-clippings"===t?"clipboard":"folder"}function track_clipping_event(t,e,n){var o,r,i,a;o=get_user_state(),r=get_page_type(),i=get_folder_type(n),a=o+"/"+i+"/"+r+"/"+e,gtag("event","Clipping",{event_action:t,event_label:a})}function track_folder_event(t,e){var n,o,r,i;n="logged_in",o=get_page_type(),r="folder",i=n+"/"+r+"/"+o,gtag("event","Folder",{event_action:t,event_label:i,value:e})}function unsubscribe_success(t,e){t.removeClass("unsubscribe").addClass("resubscribe").html("re-activate"),t.siblings("span.active").removeClass("active").addClass("inactive").html("inactive"),t.attr("href",e.resubscribe_url)}function resubscribe_success(t,e){t.removeClass("resubscribe").addClass("unsubscribe").html("suspend"),t.siblings("span.inactive").removeClass("inactive").addClass("active").html("active"),t.attr("href",e.unsubscribe_url)}function destroy_subscription_success(t,e){$(".fr-modal").jqmHide();var n=t.data("subscription-id"),o=$("ul.subscriptions").find("[data-subscription-id='"+n+"']");if(o.hide(),e.publicInspectionDocument){var r=$(".pi-doc-count-js").text();$(".pi-doc-count-js").text(r-1)}else{var i=$(".doc-count-js").text();$(".doc-count-js").text(i-1)}}function update_clippings_on_page_count(t){var e,n;e=$("#folder_metadata_bar span.clippings_on_page_count"),n=parseInt(e.html(),0),e.html(n-t)}function update_current_folder_page_counts(t){var e,n,o;e=$("h2.title").data("folder-slug"),n=$('#jump-to-folder .menu li[data-slug="'+e+'"] .document_count_inner'),o=$('#add-to-folder .menu li[data-slug="'+e+'"] .document_count_inner'),n.html(parseInt(n.html(),0)-t),o.html(parseInt(o.html(),0)-t)}function update_add_folder_count(t,e){var n;n=$('#add-to-folder .menu li[data-slug="'+t.folder.slug+'"] .document_count_inner'),void 0===e||"add"===e?n.html(parseInt(n.html(),0)+t.folder.doc_count):"remove"===e&&n.html(parseInt(n.html(),0)-t.folder.doc_count)}function update_jump_folder_count(t,e){var n;n=$('#jump-to-folder .menu li[data-slug="'+t.folder.slug+'"] .document_count_inner'),void 0===e||"add"===e?n.html(parseInt(n.html(),0)+t.folder.doc_count):"remove"===e&&n.html(parseInt(n.html(),0)-t.folder.doc_count)}function update_user_util_counts(t,e,n,o){var r,i,a,s,l;r=$("#user_utils #document-count-holder"),i=$("h2.title").data("folder-slug"),"my-clippings"===i?(a=r.find("#doc_count"),a.html(parseInt(a.html(),0)-t),n&&(s=r.find("#user_folder_count"),s.html(parseInt(s.html(),0)+1)),"delete"!==o&&(l=r.find("#user_documents_in_folders_count"),l.html(parseInt(l.html(),0)+t))):("my-clippings"===e&&("delete"!==o&&(a=r.find("#doc_count"),a.html(parseInt(a.html(),0)+t)),l=r.find("#user_documents_in_folders_count"),l.html(parseInt(l.html(),0)-t)),"delete"===o&&(l=r.find("#user_documents_in_folders_count"),l.html(parseInt(l.html(),0)-t)))}function setup_previewable_nav(t){var e=t.closest(".dropdown");e.find(".left_column li").children("a").removeClass("hover"),e.find(".left_column li").first().find("a").addClass("hover"),e.find(".right_column").children("li").hide();var n=e.find(".right_column li").first();n.show(),n.find(".carousel-rounded-box").trigger("show")}$(document).ready(function(){document.cookie="javascript_enabled=1; path=/",$("input[placeholder]").textPlaceholder()}),function(){window.getAuthenticityTokenFromHead=function(){return $('meta[name="csrf-token"]').attr("content")},$(document).ready(function(){return $.ajaxSetup({beforeSend:function(t){return t.setRequestHeader("X-CSRF-Token",getAuthenticityTokenFromHead())}})}),$(document).on("submit","form[method=post]",function(t){var e;return $(t.currentTarget).find('input[name="authenticity_token"]')?!0:(e=$('<input type="hidden" name="authenticity_token">'),e.val(getAuthenticityTokenFromHead),e.appendTo(t.currentTarget),!0)})}.call(this),function(){this.FR2||(this.FR2={}),this.CJ||(this.CJ={})}.call(this),Handlebars.registerHelper("debug",function(t){console.log("Current Context"),console.log("===================="),console.log(this),t&&(console.log("Value"),console.log("===================="),console.log(t))}),Handlebars.registerHelper("unlessMyClipboard",function(t){return"my-clippings"===this.slug?t.inverse(this):t.fn(this)}),Handlebars.registerHelper("ifInFolder",function(t,e){return _.include(this.documents,t)?e.fn(this):e.inverse(this)}),Handlebars.registerHelper("human_size",function(t){return"number"!=typeof t?"":t>=1e6?(t/1e6).toFixed(2)+" MB":(t/1e3).toFixed(2)+" KB"}),Handlebars.registerHelper("localize",function(t){var e={maxFileSize:"File is too big",minFileSize:"File is too small",acceptFileTypes:"File type not allowed",maxNumberOfFiles:"Max number of files exceeded",uploadedBytes:"Uploaded bytes exceed file size",emptyResult:"Empty file upload result"};return e[t]||t}),Handlebars.registerHelper("createDd",function(t){var e="";return $.isArray(t)?$.each(t,function(){e+="<dd>"+Handlebars.Utils.escapeExpression(this)+"</dd>"}):e="<dd>"+Handlebars.Utils.escapeExpression(t)+"</dd>",new Handlebars.SafeString(e)}),Handlebars.registerHelper("add_email_to_input",function(t){var e="";return""!==t&&(e="disabled=disabled value="+t),new Handlebars.SafeString(e)}),Handlebars.registerHelper("truncate_words",function(t,e){return new Handlebars.SafeString(t.split(" ").splice(0,e).join(" ")+"...")}),Handlebars.registerHelper("date_in_past",function(t,e){return new Date(t)>new Date?e.fn(this):e.inverse(this)}),Handlebars.registerHelper("formatted_date",function(t){return strftime("%m/%d/%Y",new Date(t))}),Handlebars.registerHelper("pluralize",function(t,e,n){return 1===t?e:n}),Handlebars.registerHelper("pluralize_array",function(t,e,n){return 1===t.length?e:n}),Handlebars.registerHelper("count",function(t){return t.length}),Handlebars.registerHelper("inColumns",function(t,e){var n,o,r,i;return i=e.hash.count,n=Math.floor(t.length/i),o=t.length%i===0?n:n+1,r=inGroupsOf(o,t),r=_.flatten(_.zip.apply(_,r)),e.fn(r)}),Handlebars.registerHelper("defaultSubscriptionToDocument",function(t,e){return"Document"===t?e.fn(this):void 0}),Handlebars.registerHelper("defaultSubscriptionToPIDocument",function(t,e){return"PublicInspectionDocument"===t?e.fn(this):void 0});var myfr2_jqmHandlers={href:"",timer:"",show:function(t){t.w.show(),closeOnEscape(t)},hide:function(t){t.w.hide(),t.o.remove()}};$(document).ready(function(){$(".dropdown.nav_myfr2 ul.subnav li a").each(function(){$(this).bind("click",function(){gtag("event","Navigation",{event_action:"Navigation",event_label:"MyFR",value:$(this).html()})})})}),function(){this.FR2.Analytics=function(){function t(){}return t.trackCommentEvent=function(e,n,o){return t.trackGAEvent(e,n,o)},t.trackGAEvent=function(t,e,n){return gtag("event",t,{event_action:e,event_label:n})},t}()}.call(this),function(){this.CJ.Tooltip=function(){function t(){}return t.addTooltip=function(t,e){var n;return n={className:"tooltip",title:function(){return $(this).data("tooltip")},gravity:function(){return $(this).data("tooltip-gravity")||"s"}},_.extend(n,e),$(t).tipsy(n)},t.addFancyTooltip=function(t,e,n){var o,r;return r={className:"tooltip",title:function(){return $(this).data("tooltip")},gravity:function(){return $(this).data("tooltip-gravity")||"s"}},_.extend(r,e),n=_.extend({},n),o=this,$(t).tipsy(r).mouseenter(function(){var t,e;return e=$(".tipsy").first(),t=$(this),o.calculateProperties(t,e,n),o.positionTooltip(e,n.position)})},t.positionTooltip=function(t,e){return"centerTop"===e?this.positionCenterTop(t):"centerLeft"===e?this.positionCenterLeft(t):"centerRight"===e?this.positionCenterRight(t):"centerBottom"===e?this.positionCenterBottom(t):void 0},t.positionCenterTop=function(e){return e.css("left",t.elProperties.position.left+t.elProperties.width/2-t.tooltipProperties.width/2+t.offset.horizontal).css("top",t.elProperties.position.top-t.tooltipProperties.height+t.offset.vertical)},t.positionCenterLeft=function(e){return e.css("left",t.elProperties.position.left-t.tooltipProperties.width+t.offset.horizontal).css("top",t.elProperties.position.top+t.elProperties.height/2-t.tooltipProperties.height/2+t.offset.vertical)},t.positionCenterRight=function(e){return e.css("left",t.elProperties.position.left+t.elProperties.width+t.offset.horizontal).css("top",t.elProperties.position.top+t.elProperties.height/2-t.tooltipProperties.height/2+t.offset.vertical)},t.positionCenterBottom=function(e){return e.css("left",t.elProperties.position.left+t.elProperties.width/2-t.tooltipProperties.width/2+t.offset.horizontal).css("top",t.elProperties.position.top+t.elProperties.height+t.offset.vertical)},t.calculateProperties=function(t,e,n){return this.offset={horizontal:null!=n.horizontalOffset?n.horizontalOffset:0,vertical:null!=n.verticalOffset?n.verticalOffset:0},this.tooltipProperties={height:e.height(),width:e.width(),position:e.position()},this.elProperties=n.svg?{height:t.attr("height"),width:t.attr("width"),position:t.offset()}:{height:t.height(),width:t.width(),position:t.offset()}},t}()}.call(this),function(){this.FR2.Modal=function(){function t(){}return t.defaults=function(){return{modalId:"#fr_modal",includeTitle:!0,modalClass:"fr-modal"}},t.displayModal=function(t,e,n){var o,r,i;return n=_.extend(this.defaults(),n),r=this.defaults().modalClass+" "+n.modalClass,o=$(n.modalId),o.length>0&&o.remove(),$("body").append("<div id='"+n.modalId.slice(1)+"'/>"),o=$(n.modalId),o.addClass(r),i=['<a href="#" class="jqmClose" "aria-label"="close"><span class="icon-fr2 icon-fr2-badge_x"></span></a>'],n.includeTitle&&i.push("<h3 class='title_bar'>"+t+"</h3>"),i.push(e),o.html(i.join("\n")),o.jqm({modal:!0,toTop:!0}),n.alternateModalCloseSelector&&o.jqmAddClose(n.alternateModalCloseSelector),o.jqmShow().centerScreen(),this.addCloseHandler(n)},t.addCloseHandler=function(t){return $(""+t.modalId).jqm({onHide:function(e){return t.onHide?t.onHide(e):(e.w.fadeOut("400",function(){return e.o.remove()}),$(""+t.modalId).trigger("modalClose"))}})},t.closeModal=function(t){return $(""+t).jqmHide(),$(""+t).trigger("modalClose")},t}()}.call(this),function(){var t=function(t,n){function o(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return o.prototype=n.prototype,t.prototype=new o,t.__super__=n.prototype,t},e={}.hasOwnProperty;this.CJ.Toggle=function(){function t(t){var e,n;if(this.el=$(t),this.parent=$(this.el.parents().first()),this.settings=this.el.data("toggle"),!this.settings||this.settings&&!this.settings.toggleTarget)throw n=new Error("CJ.Toggle :: Must provide toggleTarget as a data-toggle option");e={activeClass:"active",hiddenClass:"hidden",hideText:"hide",showText:"show",textTarget:this.el,toggleIgnore:".no-toggle",toggleTarget:null,trigger:"click"},this.settings=_.extend({},e,this.settings),this.prepTargets(),this.addToggleEvent()}return t.prototype.prepTargets=function(){var t;return t=this,_.each($(this.settings.toggleTarget),function(e){return e=$(e),e.hasClass(t.settings.hiddenClass)?e.hide().removeClass(t.settings.hiddenClass):void 0})},t}(),this.CJ.ToggleOne=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.addToggleEvent=function(){var t;return t=this,this.parent.on(this.settings.trigger,".toggle",function(e){var n;return e.preventDefault(),n=$(this),$(t.settings.toggleTarget).not(t.settings.toggleIgnore).toggle(),$(t.settings.textTarget).text("none"===$(t.settings.toggleTarget).last().css("display")?t.settings.showText:t.settings.hideText)})},n}(this.CJ.Toggle),this.CJ.ToggleAll=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.addToggleEvent=function(){var t;return t=this,this.parent.on(this.settings.trigger,".toggle-all",function(e){var n;return e.preventDefault(),n=$(this),$(t.settings.toggleAllTargeters).removeClass(t.settings.activeClass),$(t.settings.toggleAllTarget).hide(),$(t.settings.toggleTarget).show(),n.closest(t.settings.toggleAllTargeters).addClass(t.settings.activeClass)})},n}(this.CJ.Toggle)}.call(this),function(){var t=function(t,n){function o(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return o.prototype=n.prototype,t.prototype=new o,t.__super__=n.prototype,t},e={}.hasOwnProperty;this.FR2.ListItemFilter=function(){function t(t,e){this.itemList=$(t),this.settings=_.extend(this.defaultOptions(),e||{}),this.settings.filters.alphabetical&&this.addAlphaFilter(),this.settings.filters.liveFilter&&this.addLiveFilter()}return t.prototype.defaultOptions=function(){return{filters:{alphabetical:!0,liveFilter:!0},filterCountTarget:null,nestedItems:!1}},t.prototype.notifyFilterUpdate=function(t){return _.each(this.settings.filters,function(e){return function(n,o){return o!==t&&n===!0?e.resetFilter(o,t):void 0}}(this)),this.updateFilterCount()},t.prototype.resetFilter=function(t){switch(t){case"alphabetical":if(this.alphaFilter.find("li").removeClass("on"),""===this.liveFilter.find("input").val())return this.alphaFilter.find("li").first().addClass("on");break;case"liveFilter":return this.liveFilter.find("input").val(""),this.itemList.find("li[data-filter-alpha]").removeClass("unmatched")}},t.prototype.addAlphaFilter=function(){var t,e;return this.alphaFilter=$(".list-item-filter.alphabetical-filter"),e=this,t=this.itemList.find("li[data-filter-alpha]"),this.alphaFilter.on("click","li",function(n){var o,r,i;return n.preventDefault(),r=$(this),o=r.find("a"),e.alphaFilter.find("li").removeClass("on"),r.addClass("on"),"all"===o.data("regex")?t.show():(i=_.filter(t,function(t){return $(t).data("filter-alpha").match(new RegExp(o.data("filter-regex")))}),t.hide(),$(i).show()),e.notifyFilterUpdate("alphabetical")})},t.prototype.addLiveFilter=function(){var t;return this.liveFilter=$(".list-item-filter.live-filter"),t=this.liveFilter.find("input"),t.val(""),t.on("keyup",function(e){return function(){var n,o;return n=e.itemList.find("li[data-filter-live]"),""===t.val()?(n.show(),e.notifyFilterUpdate()):(o=_.filter(n,function(e){return $(e).data("filter-live").match(new RegExp("\\b"+t.val(),"i"))}),n.hide().removeClass("unmatched"),e.settings.nestedItems?_.each(o,function(t){return t=$(t),t.show(),t.parents("li[data-filter-live]").show().addClass("unmatched")}):$(o).show()),e.notifyFilterUpdate("liveFilter")}}(this))},t.prototype.updateFilterCount=function(){return this.settings.filterCountTarget?$(this.settings.filterCountTarget).html(this.itemList.find('li:visible:not(".unmatched")').length):void 0},t}(),this.FR2.TopicListFilter=function(e){function n(t,e){n.__super__.constructor.call(this,t,e)}return t(n,e),n.prototype.defaultOptions=function(){var t;return t={filterCountTarget:"#item-count"},_.extend(n.__super__.defaultOptions.call(this),t)},n}(this.FR2.ListItemFilter),this.FR2.AgencyListFilter=function(e){function n(t,e){n.__super__.constructor.call(this,t,e),this.settings.filters.subAgencies&&this.addSubAgencyFilter()}return t(n,e),n.prototype.defaultOptions=function(){var t;return t={filters:{alphabetical:!0,liveFilter:!0,subAgencies:!0},filterCountTarget:"#item-count",nestedItems:!0},_.extend(n.__super__.defaultOptions.call(this),t)},n.prototype.resetFilter=function(t,e){switch(t){case"subAgencies":return"alphabetical"===e?$(".list-item-filter.sub-agency-filter li.on").trigger("click"):($(".list-item-filter.sub-agency-filter li").removeClass("on"),$(".list-item-filter.sub-agency-filter a[data-show-sub-agencies=true]").closest("li").addClass("on"));default:return n.__super__.resetFilter.call(this,t)}},n.prototype.addSubAgencyFilter=function(){var t,e;return this.subAgencyFilter=$(".list-item-filter.sub-agency-filter"),e=this,t=this.itemList.find("li[data-sub-agency]"),this.subAgencyFilter.on("click","li",function(n){var o,r,i;return n.preventDefault(),r=$(this),o=r.find("a"),i=o.data("show-sub-agencies"),e.subAgencyFilter.find("li").removeClass("on"),r.addClass("on"),i?t.show():t.hide()})},n}(this.FR2.ListItemFilter)}.call(this),function(){var t=function(t,n){function o(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return o.prototype=n.prototype,t.prototype=new o,t.__super__=n.prototype,t},e={}.hasOwnProperty;this.FR2.ListItemSorter=function(){function t(t,e){this.itemList=$(t),this.settings=_.extend(this.defaultOptions(),e||{}),this.settings.sorters.alphabetical&&this.addAlphaSorter(),this.settings.sorters.count&&this.addCountSorter()}return t.prototype.defaultOptions=function(){return{sorters:{alphabetical:!0,count:!0}}},t.prototype.notifySorterUpdate=function(t){return _.each(this.settings.sorters,function(e){return function(n,o){return o!==t&&n===!0?e.resetSorter(o):void 0}}(this))},t.prototype.resetSorter=function(t){switch(t){case"alphabetical":return this.alphaSorter.find("li").removeClass("on");case"count":return this.countSorter.find("li").removeClass("on")}},t.prototype.addAlphaSorter=function(){var t,e;return this.alphaSorter=$(".list-item-sorter.alphabetical-sorter"),e=this,t=this.itemList.find("> li"),this.alphaSorter.on("click","li",function(n){var o,r,i,a;return n.preventDefault(),r=$(this),o=r.find("a"),i=o.data("sort-direction"),e.alphaSorter.find("li").removeClass("on"),r.addClass("on"),a=_.sortBy(t,function(t){return t=$(t),t.data("sorter-text")?t.data("sorter-text"):t.text()}),"asc"===i?e.itemList.html(a):"desc"===i&&e.itemList.html(a.reverse()),e.notifySorterUpdate("alphabetical")})},t.prototype.addCountSorter=function(){var t,e;return this.countSorter=$(".list-item-sorter.count-sorter"),e=this,t=this.itemList.find("> li"),this.countSorter.on("click","li",function(n){var o,r,i,a;return n.preventDefault(),r=$(this),o=r.find("a"),i=o.data("sort-direction"),e.countSorter.find("li").removeClass("on"),r.addClass("on"),a=_.sortBy(t,function(t){return t=$(t),t.data("sorter-count")?t.data("sorter-count"):t.text()}),"asc"===i?e.itemList.html(a):"desc"===i&&e.itemList.html(a.reverse()),e.notifySorterUpdate("count")})},t}(),this.FR2.TopicListSorter=function(e){function n(t,e){n.__super__.constructor.call(this,t,e)}return t(n,e),n}(this.FR2.ListItemSorter),this.FR2.AgencyListSorter=function(e){function n(t,e){n.__super__.constructor.call(this,t,e)}return t(n,e),n}(this.FR2.ListItemSorter)}.call(this),function(){this.FR2.NonPersistentStorage=function(){function t(){this._storage={}}return t.prototype.set=function(t,e){return this._storage[t]=e},t.prototype.get=function(t){return this._storage[t]},t}()}.call(this),function(){this.FR2.UserData=function(){function t(){var t;t=Cookies.getJSON("user_data"),this.email=t&&t.email?t.email:null}return t.prototype.signedIn=function(){return this.email&&this.email.length>0},t.prototype.email=function(){return this.email},t}()}.call(this),function(){this.FR2.UserNavigationManager=function(){function t(t){this.userData=t,this.updateMyFRNav()}return t.prototype.updateMyFRNav=function(){return this.userData.signedIn()?($(".myfr2-clipboard").removeClass("inactive"),$(".myfr2-comments").removeClass("inactive"),$(".myfr2-subscriptions").removeClass("inactive"),$(".my-account-link").removeClass("inactive")):($(".myfr2-clipboard").addClass("inactive"),$(".myfr2-comments").addClass("inactive"),$(".myfr2-subscriptions").addClass("inactive"),$(".my-account-link").addClass("inactive"))},t}()}.call(this),function(){this.FR2.UserUtils=function(){function t(){}return t.loggedIn=function(){return"1"===readCookie("expect_signed_in")?!0:"0"===readCookie("expect_signed_in")?!1:!1},t}()}.call(this),function(){this.FR2.AgencyLogoPositioner=function(){function t(){this.addEvents()}return t.prototype.addEvents=function(){return $(".agency-logo").Lazy({afterLoad:function(t){var e;return e=t.height()/4,$(".agency-header h1").attr("style","margin-top: "+e+"px !important"),t.css("margin-top",-e),t.removeClass("loading")},onError:function(t){return t.hide()}})},t}()}.call(this),function(){this.FR2.Autocompleter=function(){function t(t){this.form=t,this.input=this.form.find("input[data-autocomplete]"),this.responseCache={},this.addAutocompleter()}return t.prototype.addAutocompleter=function(){var t;return t=this,this.input.autocomplete({minLength:3,source:function(e,n){var o;return o=t.input,t.responseCache[e.term]?($(o).siblings(".loader").remove(),n(t.responseCache[e.term])):$.ajax({url:t.form.data("autocomplete").endpoint+e.term,success:function(r){var i;return $(o).siblings(".loader").remove(),i=$.map(r,function(t){return{label:t.name,value:t.name,url:t.url,id:t.id}}),t.responseCache[e.term]=i,n(i)}})},select:function(e,n){return t.input.val(n.item.name),window.location.href=n.item.url},close:function(){return t.input.val("")},search:function(){return t.input.after($("<div>").addClass("loader"))}})},t}()}.call(this),function(){this.FR2.EmbeddedSearch=function(){function t(t){this.searchForm=t,this.doctypeFilters=this.searchForm.find("#doc-type-filter li"),this.searchCount=new FR2.SearchFormCount(this.searchForm),this.setupTooltips(),this.addTooltips(),this.addMouseEvents(),this.calculateExpectedResults()}return t.prototype.setupTooltips=function(){return _.each(this.doctypeFilters,function(t){var e;return t=$(t),e=t.data("filter-doc-type-display"),t.data("tooltip","Limit search to documents of type "+e)})},t.prototype.addTooltips=function(){return this.doctypeFilters.filter(":not(.disabled)").tipsy({gravity:"n",fade:!1,offset:2,title:function(){return $(this).data("tooltip")}})},t.prototype.addMouseEvents=function(){var t,e;return t=this,e=this.searchForm.find("#doc-type-filter"),e.on("mouseenter","li",function(){return $(this).addClass("hover")}),e.on("mouseleave","li",function(){return $(this).removeClass("hover")}),e.off("click"),e.on("click","li",function(){return t.setFilterState($(this))})},t.prototype.calculateExpectedResults=function(){return this.searchCount.getResultCount()},t.prototype.setFilterState=function(t){return t.hasClass("on")?this.triggerFilterOffState(t):this.triggerFilterOnState(t)},t.prototype.triggerFilterOffState=function(t){return t.removeClass("on").removeClass("hover"),t.data("tooltip","Limit search to documents of type "+t.data("filter-doc-type-display")),t.tipsy("hide").tipsy("show"),this.searchForm.find("#conditions_type_input input#conditions_type_"+t.data("filter-doc-type")).prop("checked",!1),this.calculateExpectedResults()},t.prototype.triggerFilterOnState=function(t){return t.addClass("on"),t.data("tooltip","Remove limitation (documents of type "+t.data("filter-doc-type-display")+")"),t.tipsy("hide").tipsy("show"),this.searchForm.find("#conditions_type_input input#conditions_type_"+t.data("filter-doc-type")).prop("checked",!0),this.calculateExpectedResults()},t}()}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};this.FR2.EmailAFriend=function(){function e(e){this.documentNumber=e,this.submitFailure=t(this.submitFailure,this),this.submitSuccess=t(this.submitSuccess,this),this.removeLoaderFromButton=t(this.removeLoaderFromButton,this)}return e.prototype.display=function(){var t;return FR2.Modal.displayModal("Email the Following Document",'<div class="wrapper"><div class="loader"></div></div>',{modalClass:"email-a-friend-modal wide"}),this.modal=$("#fr_modal"),this.form=this.modal.find("form"),t=$.ajax({url:"/documents/"+this.documentNumber+"/emails/new",dataType:"html"}),t.always(function(t){return function(e){return t.modal.find(".loader").replaceWith(e),t.disableSubmit(),t.modal.on("change","input",function(){return t.validForm()?t.enableSubmit():t.disableSubmit()}),t.modal.on("submit","form",function(e){return e.preventDefault(),t.submitForm()}),t.modal.on("click","form .action.commit",function(e){return e.preventDefault(),t.submitForm()})}}(this))},e.prototype.disableSubmit=function(){return this.modal.find("form .action.commit").addClass("disabled")},e.prototype.enableSubmit=function(){return this.modal.find("form .action.commit").removeClass("disabled")},e.prototype.enabled=function(){return!this.modal.find("form .action.commit").hasClass("disabled")},e.prototype.validForm=function(){return""!==$('input[name="entry_email[sender]"]').val()&&""!==$('input[name="entry_email[recipients]"]').val()},e.prototype.submitForm=function(){var t;return this.enabled()&&!this.submitting()?(this.addLoaderToButton(),t=$.ajax({url:"/documents/"+this.documentNumber+"/emails",type:"POST",data:this.modal.find("form").serializeArray()}),t.done(function(t){return function(e){return t.submitSuccess(e)}}(this)),t.fail(function(t){return function(e){return t.submitFailure(e)}}(this)),t.always(function(t){return function(){return t.removeLoaderFromButton()}}(this))):void 0},e.prototype.addLoaderToButton=function(){var t;return t=this.modal.find("form .action.commit"),t.append($("<div>").addClass("loader")),t.addClass("submitting")},e.prototype.removeLoaderFromButton=function(){var t;return t=this.modal.find("form .action.commit"),t.find(".loader").remove(),t.removeClass("submitting")},e.prototype.submitting=function(){return this.modal.find("form .action.commit").hasClass("submitting")},e.prototype.submitSuccess=function(t){return this.modal.find(".wrapper").html(t),setTimeout(function(){return FR2.Modal.closeModal("#fr_modal")},2500)},e.prototype.submitFailure=function(t){return this.modal.find(".wrapper").html(t.responseText)},e}()}.call(this);var EmailHelper=function(){var t=function(){this.input=null,this.initialized=!1};return t.prototype={initialize:function(t){this.input=$(t),this.initialized=!0},reset_help_text:function(){this.input.closest("li").find("span.email_invalid").remove(),this.input.closest("li").find("span.email_suggestion").remove()},validate_or_suggest:function(){this.reset_help_text();var t=this.validate_email();t.has_error===!1?(this.enable_form(),this.display_or_remove_suggestion()):(this.display_error(t),this.disable_form())},validate_email:function(){var t=this.input.val(),e=!1,n="",o=/^([\w\.%\+'\-]+)@([\w\-]+\.)+([\w]{2,})$/;return""===t?(e=!0,n="blank"):o.test(t)||(e=!0,n="invalid"),{has_error:e,error:n}},display_or_remove_suggestion:function(){this.input.mailcheck({suggested:function(t,e){var n=Handlebars.compile($("#email-suggestion-template").html()),o=$(n({suggestion:e}));t.closest("li").find("span.email_suggestion").remove(),t.after(o)},empty:function(t){t.closest("li").find("span.email_suggestion").remove()}})},display_error:function(t){var e=Handlebars.compile($("#email-invalid-template").html()),n=$(e({blank:"blank"===t.error}));this.input.after(n)},use_suggestion:function(t){t.closest("li").find("input").val(t.data("suggestion")),t.closest(".email_suggestion").remove()},enable_form:function(){var t=this.input.closest("form").find("input[type=submit]");t.prop("disabled",!1),t.removeClass("disabled"),t.closest("li").removeClass("disabled")},disable_form:function(){var t=this.input.closest("form").find("input[type=submit]");t.prop("disabled",!0),t.addClass("disabled"),t.closest("li").addClass("disabled")}},t}();(function(){this.FR2.ExternalLinkChecker=function(){function t(t){this.event=t,this.el=$(this.event.target),this.url=this.el.attr("href"),this.isExternalUrl()&&!this.isOwnDomain()&&this.showModal()&&!this.isWhitelistedDomain()&&(this.event.preventDefault(),this.displayModal())}return t.WHITELISTED_DOMAINS=["www.archives.gov","www.govinfo.gov","federalregister.tenderapp.com","s3.amazonaws.com/public-inspection.","s3.amazonaws.com/archives.","agency-logos.federalregister.gov","archives.federalregister.gov","ecfr.federalregister.gov","images.federalregister.gov","public-inspection.federalregister.gov","uploads.federalregister.gov"],t.prototype.displayModal=function(){var t;return t=Handlebars.compile($("#external-link-warning-modal-template").html())({url:this.url}),FR2.Modal.displayModal("You Are Now Leaving the Federal Register",t,{modalClass:"fr-modal external-link-warning-modal"}),this.addModalEvents()},t.prototype.addModalEvents=function(){return $("#fr_modal.external-link-warning-modal form").on("submit",function(t){return function(e){return e.preventDefault(),$("#fr_modal.external-link-warning-modal input[name=accept]").prop("checked")&&amplify.store("showExternalModal",!1,{expires:2592e6}),"_blank"===t.el.attr("target")||"blank"===t.el.attr("target")?(FR2.Modal.closeModal("#fr_modal"),window.open(t.url,"_blank","noopener,noreferrer"),window.opener=null):window.location.href=t.url}}(this))},t.prototype.showModal=function(){return amplify.store("showExternalModal")!==!1},t.prototype.isOwnDomain=function(){return RegExp("^"+window.location.origin).test(this.url)},t.prototype.isExternalUrl=function(){return RegExp("^(https?:)//").test(this.url)},t.prototype.isWhitelistedDomain=function(){return _.any(this.constructor.WHITELISTED_DOMAINS,function(t){return function(e){return RegExp("^https?://"+e).test(t.url)}}(this))},t}()}).call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}},e=function(t,e){function o(){this.constructor=t}for(var r in e)n.call(e,r)&&(t[r]=e[r]);return o.prototype=e.prototype,t.prototype=new o,t.__super__=e.prototype,t},n={}.hasOwnProperty;this.FR2.Calendar=function(){function e(e){this.calendar=e,this.getNewCalendar=t(this.getNewCalendar,this),this.swapCalendars=t(this.swapCalendars,this),this.showLoader=t(this.showLoader,this),this._calendarYearBaseUrl=t(this._calendarYearBaseUrl,this),this.updateCalendarYear=t(this.updateCalendarYear,this),this.wrapper=this.calendar.closest(".calendar-wrapper"),this.addYearDropdown(),this.addClickEvents(),this.addMissingDateHandler(),this.ensureTooltips()}return e.prototype.addYearDropdown=function(){var t,e,n,o,r,i,a,s;if(0===this.calendar.find(".monthName select").length&&this.calendar.data("year-select")===!0&&(this.select=$("<select />"),a=new Date,i=parseInt(this.calendar.data("year-start"),10),t=parseInt(this.calendar.data("year-end"),10),t>i)){for(s=n=o=i,r=t;r>=o?r>=n:n>=r;s=r>=o?++n:--n)this.buildSelect(s);return this.calendar.find(".monthName").append(this.select),e=this,this.select.on("change",this.updateCalendarYear)}},e.prototype.buildSelect=function(t){var e;return e=$("<option />").append(t),parseInt(this.calendar.attr("data-calendar-year"),10)===t&&e.prop("selected",!0),this.select.append(e)},e.prototype.updateCalendarYear=function(t){return t.stopPropagation(),t.preventDefault(),$.ajax({url:this._calendarYearBaseUrl()+"/"+$(t.target).val()+"/"+this.calendar.data("calendar-month"),dataType:"html",beforeSend:this.showLoader,complete:function(t){return function(){return t.calendar.find(".loader").remove()}}(this),success:this.swapCalendars})},e.prototype._calendarYearBaseUrl=function(){return"public-inspection"===this.wrapper.data("document-type-js")?"/esi/public_inspection_issues":"/esi/document_issues/"},e.prototype.showLoader=function(){return this.calendar.remove(),this.wrapper.append('<div class="loader" />')},e.prototype.swapCalendars=function(t){return this.wrapper.find(".loader").remove(),this.wrapper.append(t),new FR2.Calendar(this.wrapper.find("table.calendar"))
},e.prototype.addClickEvents=function(){return this.changeCalendarEvent()},e.prototype.changeCalendarEvent=function(){return this.calendar.on("click",".nav",function(t){return function(e){var n;return e.stopPropagation(),e.preventDefault(),n=$(e.target),t.getNewCalendar(n.attr("href"))}}(this))},e.prototype.getNewCalendar=function(t){return $.ajax({url:t,beforeSend:function(t){return function(){return t.showLoader()}}(this),complete:function(t){return function(){return t.calendar.find(".loader").remove()}}(this),success:this.swapCalendars})},e.prototype.addMissingDateHandler=function(){return this.calendar.on("click","td.late",function(t){return t.preventDefault(),window.alert("This issue is currently unavailable; we apologize for any inconvenience.")})},e.prototype.ensureTooltips=function(){return CJ.Tooltip.addTooltip(this.calendar.find(".cj-tooltip"),{offset:5,opacity:.9,delay:.3,fade:!0})},e}(),this.FR2.MultiCalendar=function(n){function o(e,n){this.swapCalendars=t(this.swapCalendars,this),this.multiHandler=n,o.__super__.constructor.call(this,e)}return e(o,n),o.prototype.changeCalendarEvent=function(){return this.calendar.on("click",".nav",function(t){return function(e){return e.stopPropagation(),e.preventDefault(),t.multiHandler.swapCalendars(t.calendar)}}(this))},o.prototype.swapCalendars=function(t){var e;return this.wrapper.find(".loader").remove(),this.wrapper.append(t),e=this.wrapper.find("table.calendar"),this.multiHandler.updateCalendar(e)},o}(this.FR2.Calendar),this.FR2.MultiCalendarHandler=function(){function t(t){this.calendarA=new FR2.MultiCalendar($(t[0]),this),this.calendarB=new FR2.MultiCalendar($(t[1]),this)}return t.prototype.updateCalendar=function(t){return t.hasClass("cal_first")?this.calendarA=new FR2.MultiCalendar(t,this):this.calendarB=new FR2.MultiCalendar(t,this)},t.prototype.swapCalendars=function(t){var e;return e=t.hasClass("cal_first")?"backward":"forward","backward"===e?(this.calendarA.getNewCalendar(this.calendarA.calendar.find(".calendarPrev a").attr("href")),this.calendarB.getNewCalendar(this.calendarB.calendar.find(".calendarPrev a").attr("href"))):"forward"===e?(this.calendarA.getNewCalendar(this.calendarA.calendar.find(".calendarNext a").attr("href")),this.calendarB.getNewCalendar(this.calendarB.calendar.find(".calendarNext a").attr("href"))):void 0},t}()}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};this.FR2.CarouselScroller=function(){function e(e){this.onScrollEnd=t(this.onScrollEnd,this),this.carousel=$(e),this.nav=this.carousel.find(".carousel-nav"),this.carouselItems=[],this.firstPage=0,this.lastPage=this.carousel.find(".carousel-scroller > ul li").length-1,this.carouselScroller=this.createScroller(this.carousel.get(0),this.scrollerDefaults()),this.attachScrollerBehavior(),this.attachNavBehavior(),this.setupCarouselItems()}return e.prototype.createScroller=function(t,e){return new IScroll(t,e)},e.prototype.scrollerDefaults=function(){return{momentum:!1,scrollX:!0,scrollY:!1,snap:"li"}},e.prototype.attachScrollerBehavior=function(){var t;return t=this,this.carouselScroller.on("scrollStart",function(){return t.onScrollStart()}),this.carouselScroller.on("scrollEnd",function(){return t.onScrollEnd(this)})},e.prototype.onScrollStart=function(){var t;return t=this.carousel.find(".indicator li"),_.each(t,function(t){return $(t).removeClass("active")})},e.prototype.onScrollEnd=function(t){var e,n;return e=this.carousel.find(".indicator li"),n=_.find(e,function(e){return $(e).data("carousel-page")===t.currentPage.pageX}),$(n).addClass("active")},e.prototype.attachNavBehavior=function(){var t;return this.nav.on("click",".prev",function(t){return function(){return t.carouselScroller.currentPage.pageX!==t.firstPage?(t.carouselScroller.prev(),t.onScrollStart()):void 0}}(this)),this.nav.on("click",".next",function(t){return function(){return t.carouselScroller.currentPage.pageX!==t.lastPage?(t.carouselScroller.next(),t.onScrollStart()):void 0}}(this)),t=this,this.nav.on("click","li",function(){var e;return e=$(this).data("carousel-page"),t.carouselScroller.currentPage.pageX!==e?(t.carouselScroller.goToPage(e,0),t.onScrollStart()):void 0})},e.prototype.setupCarouselItems=function(){return _.each(this.carousel.find(".carousel-rounded-box"),function(t){return function(e){return t.carouselItems.push(new FR2.CarouselItem(e,t))}}(this))},e.prototype.show=function(){return _.each(this.carouselItems,function(t){return t.show()})},e}(),this.FR2.CarouselItem=function(){function t(t,e){this.box=$(t),this.parent=e,this.attachBehavior()}var e,n;return n=10,e=5,t.prototype.attachBehavior=function(){return this.box.on("show",function(t){return function(){var o,r,i,a;return t.box.data("setup-complete")?void 0:(t.parent.carouselScroller.refresh(),i=t.box.find(".text-wrapper"),a=t.box.find(".text-wrapper-bg"),a.css("height",i.height()+n).css("width",i.width()+n),o=t.box.find(".attribution"),r=t.box.find(".attribution-bg"),r.css("height",o.height()).css("width",o.width()+e),t.box.data("setup-complete",!0))}}(this))},t.prototype.show=function(){return $(this.box).trigger("show")},t}()}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};this.FR2.ClippingElementFolderHandler=function(){function e(e,n){this.updateUserUtilCounts=t(this.updateUserUtilCounts,this),this.folderEl=$(e),this.documentNumber=n,this.addMouseEvents()}return e.prototype.addMouseEvents=function(){return this.addMouseEnterEvents(),this.addMouseLeaveEvents()},e.prototype.removeEvents=function(){return this.folderEl.off("mouseenter"),this.folderEl.off("mouseleave")},e.prototype.addMouseEnterEvents=function(){return this.folderEl.on("mouseenter",function(t){return function(){return t.folderEl.addClass("hover"),t.removeInFolderIcon(),t.addGotoFolderButton(),t.addDeleteClippingButton()}}(this))},e.prototype.addMouseLeaveEvents=function(){return this.folderEl.on("mouseleave",function(t){return function(){return t.folderEl.removeClass("hover"),t.removeGotoFolderButton(),t.removeDeleteClippingButton(),t.addInFolderIcon()}}(this))},e.prototype.addInFolderIcon=function(){var t;return 0===this.folderEl.find("a span.checked.icon").length?(t=$("<span>").addClass("checked icon icon-fr2 icon-fr2-badge_check_mark"),this.folderEl.find("a").append(t)):void 0},e.prototype.removeInFolderIcon=function(){return this.folderEl.find("a span.checked.icon").remove()},e.prototype.addGotoFolderButton=function(){var t;return t=$("<span>").addClass("goto icon icon-fr2 icon-fr2-badge_forward_arrow"),this.folderEl.find("a").append(t),t.on("click",function(t){return function(e){var n;return e.preventDefault(),e.stopPropagation(),n=t.folderEl.data("slug"),window.location.href="/my/folders/"+n}}(this))},e.prototype.removeGotoFolderButton=function(){return this.folderEl.find("a span.goto.icon").remove()},e.prototype.addDeleteClippingButton=function(){var t;return t=$("<span>").addClass("delete icon icon-fr2 icon-fr2-badge_x"),this.folderEl.find("a").append(t),t.on("click",function(t){return function(e){return e.preventDefault(),e.stopPropagation(),t.removeClippingFromFolder()}}(this))},e.prototype.removeDeleteClippingButton=function(){return this.folderEl.find("a span.delete.icon").remove()},e.prototype.removeClippingFromFolder=function(){var t,e;return this.folderEl.find("a span.icon").hide(),this.folderEl.find("a span.loader").show(),track_clipping_event("remove",this.document_number,this.folderEl.data("slug")),e={folder_clippings:{folder_slug:this.folderEl.data("slug"),document_number:this.documentNumber}},t=$.ajax({url:"/my/folder_clippings/delete",data:e,type:"POST",beforeSend:function(t){return t.setRequestHeader("X-CSRF-Token",$('meta[name="csrf-token"]').attr("content"))}}),t.done(function(t){return function(e){return t.folderEl.removeClass("in-folder").addClass("not-in-folder"),t.folderEl.find("a span.icon").remove(),t.folderEl.find("a span.loader").hide(),t.addInFolderIcon(),t.updateUserUtilCounts(e),t.removeEvents(),t.folderEl.trigger("removeHandler",t.folderEl.data("slug"))}}(this))},e.prototype.updateUserUtilCounts=function(t){var e;return"my-clippings"!==this.folderEl.data("slug")?(e=$("#user_utils #document-count-holder #user_documents_in_folders_count"),e.html(parseInt(e.html(),0)-t.folder.doc_count)):(e=$("#user_utils #document-count-holder #doc_count"),e.html(parseInt(e.html(),0)-t.folder.doc_count))},e}()}.call(this),function(){this.FR2.ClippingsFolderHandler=function(){function t(t,e){this.modal=t,"string"==typeof e?(this.documentNumber=e,this.clippingIds=null):"object"==typeof e&&(this.documentNumber=null,this.clippingIds=e),this.form=this.modal.find("form"),this.form.on("submit",function(t){return function(e){return e.preventDefault(),e.stopPropagation(),t.create()}}(this)),this.form.on("click",".action.commit",function(t){return function(e){return e.preventDefault(),e.stopPropagation(),t.create()}}(this))}return t.prototype.create=function(){return""!==this.form.find("input#folder_name").val()?(this.removeFailState(),this.setSavingState(),this.submit()):void 0},t.prototype.hideFormMessages=function(){return this.form.find(".folder_error").hide(),this.form.find(".folder_success").hide(),this.form.find(".folder_create").hide()},t.prototype.setSavingState=function(){return this.form.find("li.action.commit").addClass("saving").append($("<div>").addClass("loader")),this.form.find("button[type=submit]").val("Creating folder and saving clipping(s)...").prop("disabled",!0)},t.prototype.removeSavingState=function(){return this.form.find("li.action.commit").removeClass("saving").find($(".loader")).remove(),this.form.find("button[type=submit]").val("").prop("disabled",!1)},t.prototype.setSuccessState=function(t){var e;return e=this,this.removeSavingState(),this.form.find("button[type=submit]").val("Folder created and clipping added").prop("disabled",!1),setTimeout(function(){return e.modal.trigger("folderCreated",t),e.closeModal()},1e3)},t.prototype.setFailState=function(t){var e,n;return this.removeSavingState(),this.form.find("button[type=submit]").val("Create Folder").prop("disabled",!1),n=$.parseJSON(t.responseText),e=this.modal.find(".folder_error"),e.find("p .message").html(n.errors[0]),e.show()},t.prototype.removeFailState=function(){var t;return t=this.modal.find(".folder_error"),t.find("p .message").html(""),t.hide()},t.prototype.submit=function(){var t,e,n;return n=this.form.find("input#folder_name").val(),t=[{name:"folder[name]",value:n}],this.documentNumber?t.push({name:"folder[document_numbers][]",value:this.documentNumber}):this.clippingIds&&t.push({name:"folder[clipping_ids]",value:this.clippingIds}),e=$.ajax({url:"/my/folders",data:t,type:"POST",beforeSend:function(t){return t.setRequestHeader("X-CSRF-Token",$('meta[name="csrf-token"]').attr("content"))}}),e.done(function(t){return function(e){return track_folder_event("create",1),track_clipping_event("add",t.document_number,n),t.setSuccessState(e)}}(this)),e.fail(function(t){return function(e){return t.setFailState(e)}}(this))},t.prototype.closeModal=function(){return this.modal.find("a.jqmClose").click()},t}()}.call(this),function(){FR2.Clipboard=function(){function t(){}return t.prototype.success=!1,t.prototype.copyToClipboard=function(t){return window.clipboardData?this._IECopy(t):this._standardCopy(t),this.success},t.prototype._IECopy=function(t){return this.success=window.clipboardData.setData("Text",t)},t.prototype._FFCopy=function(t){return window.prompt("Your browser does not support automated copy. Please copy the text below and close this window when you are done.",t),this.success=!1},t.prototype._standardCopy=function(t){var e,n,o,r;r=$("<div>"),r.css({position:"absolute",left:"-1000px",top:"-1000px"}),r.text(t),$("body").append(r),n=document.createRange(),n.selectNodeContents(r.get(0)),o=window.getSelection(),o.removeAllRanges(),o.addRange(n);try{return this.success=document.execCommand("copy",!1,null)}catch(i){return e=i,this._FFCopy(t)}finally{r.remove()}},t}()}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};this.FR2.DocumentClipper=function(){function e(e){this.runFolderCreationHandler=t(this.runFolderCreationHandler,this),this.rebindAndCloseClippingMenu=t(this.rebindAndCloseClippingMenu,this),this.updateClippedStatus=t(this.updateClippedStatus,this),this.clipper=$(e),this.documentNumber=this.clipper.data("document-number"),this.folderElementHandlers={},this.hideAndDisableForm(),this.addClipper(),this.addClipperEvents(),this.addTooltip()}return e.prototype.clipperTemplate=function(){return Handlebars.compile($("#add-to-folder-menu-fr2-template").html())},e.prototype.hideAndDisableForm=function(){return this.clipper.find("form.add-to-clipboard").hide().bind("submit",function(t){return t.preventDefault()})},e.prototype.folderDetails=function(){return FR2.currentUserStorage.get("userFolderDetails")},e.prototype.addClipper=function(){var t,e,n;return t=this.clipper.find("li.clip-for-later"),n=_.clone(this.folderDetails()),e=_.extend(n,{currentDocumentNumber:this.documentNumber,clipped:this.documentClipped()}),t.append(this.clipperTemplate()(e))},e.prototype.addClipperEvents=function(){return this.addMouseEvents(),this.addClickEvents(),this.addFolderElementHandlers()},e.prototype.addMouseEvents=function(){var t;return t=this,this.clipper.on("mouseenter",".add-to-folder",function(){return t.showClippingMenu(this)}),this.clipper.on("mouseleave",".add-to-folder",function(){return t.hideClippingMenu(this)})},e.prototype.addClickEvents=function(){var t,e;return t=this,e=this.clipper.find(".menu"),e.on("click","li, li a",function(t){return t.preventDefault()}),this.clipper.on("click",".button",function(){return t.documentInClipboard()?void 0:e.find('li[data-slug="my-clippings"]').trigger("click")}),e.on("click","li.not-in-folder",function(){return t.addDocumentToFolder($(this))}),e.on("click","#new-folder",function(){return t.handleNewFolderAction()})},e.prototype.addFolderElementHandlers=function(){return _.each(this.clipper.find(".menu li.in-folder"),function(t){return function(e){return t.addFolderElementHandler(e)}}(this))},e.prototype.showClippingMenu=function(t){return $(t).addClass("hover")},e.prototype.hideClippingMenu=function(t){return $(t).removeClass("hover")},e.prototype.addTooltip=function(){return CJ.Tooltip.addTooltip(this.clipper.find(".add-to-folder"),{offset:2})},e.prototype.documentClipped=function(){var t;return t=this,0!==_.filter(this.folderDetails().folders,function(e){return _.contains(e.documents,t.documentNumber)}).length},e.prototype.documentInClipboard=function(){var t;return t=_.find(this.folderDetails().folders,function(t){return"my-clippings"===t.slug}),_.contains(t.documents,this.documentNumber)},e.prototype.addDocumentToFolder=function(t){var e,n,o;return FR2.UserUtils.loggedIn()?(o=this,t.find(".icon.checked").hide(),t.find(".loader").show(),track_clipping_event("add",this.documentNumber,t.data("slug")),n=[{name:"document[document_number]",value:this.documentNumber},{name:"document[folder]",value:t.data("slug")},{name:"ajax_request",value:!0}],e=$.ajax({url:"/my/clippings",data:n,type:"POST"}),e.done(function(e){return t.removeClass("not-in-folder").addClass("in-folder"),o.updateClippedStatus(),o.addFolderElementHandler(t),"my-clippings"===t.data("slug")?update_user_clipped_document_count(stored_document_numbers):update_user_folder_document_count(e)}),e.always(function(){return t.find(".loader").hide(),t.find(".icon.checked").show()})):this.displayAccountNeededModal()},e.prototype.updateClippedStatus=function(){return this.clipper.find(".menu .in-folder").length>0?this.clipper.find(".icon-fr2-flag").addClass("clipped"):this.clipper.find(".icon-fr2-flag").removeClass("clipped")},e.prototype.handleNewFolderAction=function(){return this.clipper.unbind("mouseleave"),this.clipper.addClass("hover"),this.clipper.find(".menu li#new-folder").addClass("hover"),FR2.UserUtils.loggedIn()?this.displayNewFolderModal():this.displayAccountNeededModal()},e.prototype.displayNewFolderModal=function(){var t;return t=Handlebars.compile($("#new-folder-modal-template").html()),FR2.Modal.displayModal("",t(),{includeTitle:!1,modalClass:"new-folder-modal"}),$("body").on("folderCreated","#fr_modal",this.runFolderCreationHandler),this.folderHandler=new FR2.ClippingsFolderHandler($("#fr_modal.new-folder-modal"),this.documentNumber)},e.prototype.displayAccountNeededModal=function(){var t,e,n;return t=Handlebars.compile($("#account-needed-modal-template").html()),n={redirect_to:window.location.href},e="/auth/sign_in?"+$.param(n),FR2.Modal.displayModal("",t({redirectUrl:e}),{includeTitle:!1}),this.addModalClosedHandler()},e.prototype.addModalClosedHandler=function(){return $("body").on("modalClose","#fr_modal",this.rebindAndCloseClippingMenu)},e.prototype.rebindAndCloseClippingMenu=function(){var t;return this.folderHandler=null,$("body").off("modalClose","#fr_modal",this.rebindAndCloseClippingMenu),t=this,this.clipper.on("mouseleave",".add-to-folder",function(){return t.hideClippingMenu(this)}),t.hideClippingMenu(this.clipper.find(".add-to-folder"))},e.prototype.runFolderCreationHandler=function(t,e){return update_user_folder_and_document_count(e),this.addNewFolderToMenus(e),$("body").off("folderCreated","#fr_modal",this.runFolderCreationHandler)},e.prototype.addNewFolderToMenus=function(t){var e,n;return n=Handlebars.compile($("#add-to-folder-menu-li-fr2-template").html()),e=$(n(t)),this.clipper.find(".menu ul").append(e.css("opacity",0).animate({opacity:1},{duration:1500,done:function(t){return function(){return t.addFolderElementHandler(e),t.rebindAndCloseClippingMenu()}}(this)})),this.clipper.find(".icon-fr2-flag").addClass("clipped"),_.each($(".document-clipping-actions"),function(o){return function(r){return o.clipper.is($(r))?void 0:(e=$(n(t)),$(r).find(".menu ul").append(e),e.removeClass("in-folder").addClass("not-in-folder"))}}(this))},e.prototype.addFolderElementHandler=function(t){var e;return e=new FR2.ClippingElementFolderHandler(t,this.documentNumber),this.folderElementHandlers[$(t).data("slug")]=e,$(t).on("removeHandler",function(t){return function(e,n){return t.folderElementHandlers[n]=null,t.updateClippedStatus()}}(this))},e}()}.call(this),function(){this.FR2.ParagraphCitation=function(){function t(t){this.contentArea=t,this.addEvents(),this.cb=new FR2.Clipboard}return t.prototype.addEvents=function(){return this.addTooltip(),this.enterElement(),this.enterIcon(),this.leaveElement(),this.clickIcon()},t.prototype.citationTargetEls=function(){return"*[id^=p-]"},t.prototype.singleLineHeight=27,t.prototype.icon=function(){return $(".citation-target-icon")},t.prototype.background=function(){return $(".citation-target-background")},t.prototype.addTooltip=function(){return CJ.Tooltip.addFancyTooltip(this.icon(),{className:"paragraph-citation-tooltip",delay:.3,fade:!0,gravity:"w",opacity:1},{horizontalOffset:-3,position:"centerRight",verticalOffset:-8})},t.prototype.enterElement=function(){return this.contentArea.on("mouseenter tap",this.citationTargetEls(),function(t){return function(e){var n;return n=$(e.currentTarget),n.hasClass("citation-hover-present")?void 0:(t.background().hide(),t.icon().hide(),n.addClass("citation-hover-present"),n.height()<=t.singleLineHeight&&n.addClass("single-line"),n.hasClass("amendment-part")&&n.find(".amendment-part-subnumber").length&&n.addClass("amdpar-subnumber-present"),t.icon().data("citation-target","#"+n.attr("id")),t.moveIconTo(n),t.icon().show())}}(this))},t.prototype.enterIcon=function(){return this.contentArea.on("mouseenter tap",".citation-target-icon",function(t){return function(){var e,n;return n=$(t.icon().data("citation-target")),t.moveBackgroundTo(n),t.background().css("height",n.height()+parseInt(t.background().css("padding-top"))+parseInt(t.background().css("padding-bottom"))),e=t.background().parent("p").hasClass("amendment-part")?58:38,t.background().css("width",n.width()+e),t.background().show()}}(this))},t.prototype.leaveElement=function(){return this.contentArea.on("mouseleave",this.citationTargetEls(),function(t){return function(e){var n;return n=$(e.currentTarget),t.background().hide(),t.icon().hide(),n.removeClass("citation-hover-present")}}(this))},t.prototype.clickIcon=function(){return this.contentArea.on("click tap",".citation-target-icon",function(t){return function(){return t.pulse(),t.copyUrlToClipboard(),t.setTooltipSuccessMessage()}}(this))},t.prototype.moveBackgroundTo=function(t){return t.append($(".citation-target-background"))},t.prototype.moveIconTo=function(t){return t.prepend($(".citation-target-icon"))},t.prototype.pulse=function(){return this.background().addClass("pulse"),this.icon().addClass("pulse"),setTimeout(function(t){return function(){return t.background().removeClass("pulse"),t.icon().removeClass("pulse")}}(this),200)},t.prototype.copyUrlToClipboard=function(){return this.cb.copyToClipboard(this.citationUrl())},t.prototype.citationUrl=function(){return this.icon().data("short-url")+"/"+this.icon().data("citation-target").slice(1)},t.prototype.setTooltipSuccessMessage=function(){return $(".tipsy .tipsy-inner").text("Citation copied to clipboard")},t}()}.call(this),function(){var t,e;t=function(){function t(){}return t.prototype.screen_sheets=$("head link[media=screen]"),t.prototype.print_sheets=$("head link[media=print]"),t.prototype.enter=function(){return this.screen_sheets.attr("media","none"),this.print_sheets.attr("media","all"),$("body").addClass("print_view").trigger("printView.enter")},t.prototype.exit=function(){return $("body").hasClass("print_view")?(this.screen_sheets.attr("media","screen"),this.print_sheets.attr("media","print"),$("body").removeClass("print_view").trigger("printView.exit")):void 0},t}(),e=new t,$(window).bind("hashchange",function(){return"#print"===location.hash?e.enter():e.exit()}).trigger("hashchange")}.call(this),function(){this.FR2.SearchFacetHandler=function(){function t(t){_.each(t,function(t){return new CJ.ToggleOne(t)})}return t}()}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};this.FR2.SearchFormHandler=function(){function e(e){this.searchForm=e,this.inputDataShowFieldChange=t(this.inputDataShowFieldChange,this),this.initializeAdvancedSearch=t(this.initializeAdvancedSearch,this),this.toggleAdvancedSearch=t(this.toggleAdvancedSearch,this),this.clearForm=t(this.clearForm,this),this.searchCount=new FR2.SearchFormCount(this.searchForm),this.agencyAutocompleter=new FR2.SearchFormAgencyAutocompleter(this.searchForm),this.addEvents(),this.setup()}return e.prototype.addEvents=function(){return $("#conditions_type_presdocu").bind("click",this.togglePresidentialDocumentTypes),$(".clear_form").bind("click",this.clearForm),$("#toggle_advanced").bind("click",this.toggleAdvancedSearch),$("input[data-show-field]").bind("change",this.inputDataShowFieldChange)},e.prototype.setup=function(){return this.togglePresidentialDocumentTypes(),this.initializeAdvancedSearch(),$(".date_options .date").hide(),$(".date_options input[data-show-field]:checked").trigger("change"),_.each($("input[data-show-field]"),this.intializeInputDataShowFields),this.addHelperText()},e.prototype.togglePresidentialDocumentTypes=function(){var t;return t=$(".presidential_dependent"),$("#conditions_type_presdocu").prop("checked")?t.show().find(":input").removeAttr("disabled"):t.hide().find(":input").prop("disabled","disabled")},e.prototype.clearForm=function(t){return t.preventDefault(),this.searchForm.find("input[type=text],input[type=hidden]").val(""),this.searchForm.find("input[type=radio],input[type=checkbox]").removeAttr("checked").change(),this.searchForm.find("select option:eq(0)").prop("selected","selected"),this.searchForm.find("#conditions_agency_ids option").remove(),this.searchForm.find("#conditions_within option:eq(3)").prop("selected","selected"),this.searchForm.find(".bsmListItem").remove(),this.searchForm.find(".date").hide().find("input").val(""),this.calculateExpectedResults()},e.prototype.toggleAdvancedSearch=function(){var t;return t="#advanced"===location.hash,t?this.closeAdvancedSearch():this.openAdvancedSearch()},e.prototype.initializeAdvancedSearch=function(){var t;return t="#advanced"===location.hash,t?this.openAdvancedSearch():this.closeAdvancedSearch()},e.prototype.openAdvancedSearch=function(){return $(".advanced").addClass("open"),window.location.hash="#advanced",$("#toggle_advanced").text("Hide Advanced Search"),this.calculateExpectedResults()},e.prototype.closeAdvancedSearch=function(){return $(".advanced").removeClass("open"),window.location.hash="",$("#toggle_advanced").text("Show Advanced Search"),this.calculateExpectedResults(),!1},e.prototype.inputDataShowFieldChange=function(t){var e,n;return e=$(t.currentTarget),n=e.closest("fieldset"),n.find(".date").hide().find(":input").prop("disabled",!0),e.prop("checked")&&n.find("."+e.attr("data-show-field")).show().find(":input").prop("disabled",!1),this.calculateExpectedResults()},e.prototype.intializeInputDataShowFields=function(t){var e,n;return t=$(t),n=t.closest("fieldset"),e=n.find("."+t.attr("data-show-field")+" :input"),_.each(e,function(e){return""===$(e).val()||$(e).hasClass("text-placeholder")?void 0:(t.prop("checked",!0),t.change())})},e.prototype.addHelperText=function(){return this.searchForm.find(".range_start input").after("<span class='input-connector'> to </span>"),this.searchForm.find(".cfr li:first-child input").after("<span class='input-connector'> CFR </span>"),this.searchForm.find(".zip li:first-child input").after("<span class='input-connector'> within </span>")},e.prototype.calculateExpectedResults=function(){return this.searchCount.getResultCount()},e}()}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};this.FR2.SearchCount=function(){function e(e){this.type=e,this.searchCountSuccess=t(this.searchCountSuccess,this),this.count=t(this.count,this),this.searchCountStore.init()}return e.prototype.searchCountStore={init:function(){return void 0===amplify.store("searchCount")?amplify.store("searchCount",{}):void 0},get:function(t){return amplify.store("searchCount")[t]},set:function(t,e){var n,o;return o=_.extend(amplify.store("searchCount"),(n={},n[""+t]=e,n)),amplify.store("searchCount",o,{expires:3e5})}},e.prototype.currentRequest=null,e.prototype.countUrl=function(t){return"/"+this.type+"/search/count?"+t},e.prototype.count=function(t){var e,n;return this.deferred=$.Deferred(),n=this.countUrl(t),void 0===this.searchCountStore.get(n)?(e=this,this.currentRequest=n,$.ajax(n).done(function(t){return e.searchCountSuccess(n,t)})):this.returnResponse(this.searchCountStore.get(n)),this.deferred.promise()},e.prototype.searchCountSuccess=function(t,e){return this.searchCountStore.set(t,e),this.currentRequest===t?(null===this.currentRequest,this.returnResponse(e)):void 0},e.prototype.returnResponse=function(t){return this.deferred.resolve(t)},e}()}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};this.FR2.SearchFormCount=function(){function e(e){this.searchForm=e,this.getResultCount=t(this.getResultCount,this),this.searchCount=new FR2.SearchCount(this.searchFormType()),this.addEvents()}return e.prototype.searchFormType=function(){return this.searchForm.hasClass("documents")?"documents":this.searchForm.hasClass("public-inspection")?"public-inspection":void 0},e.prototype.populateExpectedResults=function(t){var e,n;return e=numeral(t.count).format("0,0"),n="1"===e?e+" document":e+" documents",$("#expected_result_count").find(".loader").hide(),$("#expected_result_count").find(".document-count").text(n).show()},e.prototype.indicateLoading=function(){return $("#expected_result_count").show(),$("#expected_result_count").find(".document-count").hide(),$("#expected_result_count").find(".loader").show()},e.prototype.getResultCount=function(){var t;return t=this.searchForm.find(":input[value!='']:not([data-show-field]):not('.text-placeholder')").serialize(),this.indicateLoading(),this.searchCount.count(t).then(function(t){return function(e){return t.populateExpectedResults(e)}}(this))},e.prototype.addEvents=function(){var t;return t=this,this.searchForm.find("select, input").bind("blur",function(){return t.getResultCount()}),this.searchForm.find("input[type=radio]").bind("change",function(){return t.getResultCount()}),this.searchForm.find("input[type=checkbox]").bind("change",function(){return t.getResultCount()}),this.searchForm.find("#conditions_agencies").bind("change",function(){return t.getResultCount()}),this.addTypewatch()},e.prototype.addTypewatch=function(){var t;return t={callback:this.getResultCount,wait:350,captureLength:3,highlight:!1},this.searchForm.find("input[type=text]").typeWatch(t)},e}()}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};this.FR2.SearchTabCount=function(){function e(e,n){this.searchForm=e,this.searchTab=n,this.getResultCount=t(this.getResultCount,this),this.searchCount=new FR2.SearchCount(this.searchTabType()),this.linkEl=$(this.searchTab).find("a"),this.resultEl=$(this.searchTab).find(".number_of_results"),this.addEvents()}return e.prototype.searchTabType=function(){return this.searchTab.hasClass("documents")?"documents":this.searchTab.hasClass("public-inspection")?"public-inspection":void 0},e.prototype.populateExpectedResults=function(t){return this.linkEl.attr("href",t.url),this.resultEl.html(t.count)},e.prototype.indicateLoading=function(){return this.resultEl.html("<div class='loader'></div>")},e.prototype.getResultCount=function(){var t;return t=this.searchForm.find(":input[value!='']:not([data-show-field]):not('.text-placeholder')").serialize(),this.indicateLoading(),this.searchCount.count(t).then(function(t){return function(e){return t.populateExpectedResults(e)}}(this))},e.prototype.addEvents=function(){var t;return t=this,this.searchForm.find("select, input").bind("blur",function(){return t.getResultCount()}),this.searchForm.find("input[type=radio]").bind("change",function(){return t.getResultCount()}),this.searchForm.find("input[type=checkbox]").bind("change",function(){return t.getResultCount()}),this.searchForm.find("#conditions_agencies").bind("change",function(){return t.getResultCount()}),this.addTypewatch()},e.prototype.addTypewatch=function(){var t;return t={callback:this.getResultCount,wait:350,captureLength:3,highlight:!1},this.searchForm.find("input[type=text]").typeWatch(t)},e}()}.call(this),function(){this.FR2.SearchFormAgencyAutocompleter=function(){function t(t){this.searchForm=t,this.agencyInput=this.searchForm.find("input[data-autocomplete]#document-agency-search"),this.addAutocompleter()}return t.prototype.addAutocompleter=function(){var t;return this.searchForm.find("select[multiple]").hide().bsmSelect({removeClass:"remove icon-fr2 icon-fr2-badge_x",removeLabel:""}),t=this,this.agencyInput.autocomplete({minLength:3,source:function(e,n){var o;return o=t.agencyInput,$.ajax({url:"/agencies/suggestions?term="+e.term,success:function(t){return $(o).siblings(".loader").remove(),n($.map(t,function(t){return{label:t.name,value:t.name,id:t.slug}}))}})},select:function(t,e){return $("#conditions_agencies").append("<option value="+e.item.id+" selected='selected'>"+e.item.label+"</option>"),$("#conditions_agencies").trigger("change"),$(this).data("clear-value",1)},close:function(){var t;return t=$(this),t.data("clear-value")?(t.val(""),t.data("clear-value",0)):void 0},search:function(){return $(this).after($("<div>").addClass("loader"))}})},t}()}.call(this),function(){this.FR2.SubscriptionHandler=function(){function t(){}return t.generateModal=function(){return FR2.Modal.displayModal("",this.modalHtml(),{includeTitle:!1,modalClass:"subscription-modal wide"}),this.addModalBehavior()},t.addModalBehavior=function(){return this.handleSubmit()},t.handleSubmit=function(){return $(".fr-modal form.subscription .commit.button").on("click",function(t){return t.stopPropagation(),$(this).closest("form.subscription").submit()}),$(".fr-modal form.subscription").on("submit",function(t){var e,n,o,r,i,a,s;return t.preventDefault(),t.stopPropagation(),n=$(this),i=n.find("input:radio[name='subscription[search_type]']:checked"),s=n.find("input:radio[name='subscription[search_type]']").closest("li.radio"),r=n.find('input[name="subscription[search_type]"]:checked'),e=n.find("#subscription_email"),e.removeClass("error"),s.removeClass("error"),i.val()?(a=$.param({subscription:{search_conditions:i.data("subscription-params"),search_type:r.val(),email:e.val()}}),n.attr("action","/my/subscriptions?"+a),o=$('<input type="hidden" name="authenticity_token">'),o.val(getAuthenticityTokenFromHead),o.appendTo(n),n.find(".button.commit").addClass("submitting"),n.find(".button.commit input").prop("disabled",!0),n.unbind("submit").submit()):s.addClass("error")
})},t.modalHtml=function(){var t;return t=_.map(this.subscriptionFeeds(),function(t){return function(e){return t.extractDataFromFeed($(e))}}(this)),this.modalTemplate()({elements:t,email_address:FR2.currentUserStorage.get("userEmailAddress")})},t.modalTemplate=function(){return Handlebars.compile($("#subscription-modal-template").html())},t.subscriptionFeeds=function(){return $("link.subscription_feed")},t.extractDataFromFeed=function(t){var e;return e={title:t.attr("title"),url:t.attr("href"),escapedUrl:encodeURIComponent(t.attr("href")),documentSubscriptionParams:JSON.stringify(t.data("document-search-conditions")),publicInspectionSubscriptionParams:JSON.stringify(t.data("public-inspection-search-conditions")),defaultSearchType:t.data("default-search-type")},(e.documentSubscriptionParams||e.publicInspectionSubscriptionParams)&&(e.emailSubscriptionAction=!0),e},t}()}.call(this),function(){var t=function(t,e){return function(){return t.apply(e,arguments)}};this.FR2.ClippingsManager=function(){function e(e){this.crossFadeUpdateAndDocumentCounts=t(this.crossFadeUpdateAndDocumentCounts,this),this.runFolderCreationHandler=t(this.runFolderCreationHandler,this),this.rebindAndCloseClippingMenu=t(this.rebindAndCloseClippingMenu,this),this.actionBar=$(e),this.addMenus(),this.addEvents()}return e.prototype.addMenus=function(){return this.addViewFolderMenu(),this.addAddToFolderMenu()},e.prototype.addViewFolderMenu=function(){var t;return t=Handlebars.compile($("#jump-to-folder-menu-template").html()),this.actionBar.append(t(user_folder_details))},e.prototype.addAddToFolderMenu=function(){var t;return t=Handlebars.compile($("#add-to-folder-menu-template").html()),this.actionBar.append(t(user_folder_details))},e.prototype.addEvents=function(){var t;return t=this,this.actionBar.on("click",".add-to-folder #new-folder",function(e){return e.preventDefault(),t.handleNewFolderAction()}),this.actionBar.on("click",".add-to-folder li:not(#new-folder)",function(e){return e.preventDefault(),t.moveItemsToFolder(this)}),this.actionBar.on("mouseenter",".add-to-folder",function(){return t.showMenu(this)}),this.actionBar.on("mouseleave",".add-to-folder",function(){return t.hideMenu(this)}),this.actionBar.on("mouseenter",".jump-to-folder",function(){return t.showMenu(this)}),this.actionBar.on("mouseleave",".jump-to-folder",function(){return t.hideMenu(this)}),this.actionBar.on("click",".remove-clipping",function(e){return e.preventDefault(),t.deleteClippings()})},e.prototype.showMenu=function(t){return $(t).addClass("hover")},e.prototype.hideMenu=function(t){return $(t).removeClass("hover")},e.prototype.clippingIds=function(){return _.map($("form#folder_clippings input:checked"),function(t){return $(t).closest("li").data("doc-id")})},e.prototype.deleteClippings=function(){var t,e,n,o;return this.clippingIds()?(t=$("h2.title").data("folder-slug"),n=$("form#folder_clippings"),o=n.serializeArray(),o.push({name:"folder_clippings[clipping_ids]",value:this.clippingIds()}),o.push({name:"folder_clippings[folder_slug]",value:t}),e=$.ajax({url:"/my/folder_clippings/delete",data:o,type:"POST"}),e.done(function(t){return _.each(t.folder.documents,function(t){return $("#clippings li[data-doc-id='"+t+"']").animate({opacity:0},600)}),setTimeout(function(){return _.each(t.folder.documents,function(t){return $("#clippings li[data-doc-id='"+t+"']").remove()}),update_clippings_on_page_count(t.folder.doc_count),update_add_folder_count(t,"remove"),update_jump_folder_count(t,"remove"),update_user_util_counts(t.folder.doc_count,t.folder.slug,!1,"delete")},600)})):!1},e.prototype.handleNewFolderAction=function(){return this.actionBar.off("mouseleave",".add-to-folder"),this.actionBar.find(".add-to-folder .menu li#new-folder").addClass("hover"),FR2.UserUtils.loggedIn()?this.displayNewFolderModal():this.displayAccountNeededModal()},e.prototype.moveItemsToFolder=function(t){var e,n,o,r,i,a,s,l,c;return e=$("form#folder_clippings input:checked"),n=$("h2.title").data("folder-slug"),c=$(t).data("slug"),e.length>0&&c!==n?(a=$(t).find("a"),o=a.find(".document_count"),s=a.find(".loader"),o.css("opacity",0),s.show(),r=$("form#folder_clippings"),i=r.serializeArray(),i.push({name:"folder_clippings[clipping_ids]",value:this.clippingIds()}),i.push({name:"folder_clippings[folder_slug]",value:c}),l=$.ajax({url:"/my/folder_clippings",data:i,type:"POST"}),l.done(function(t){return function(e){var n,r;return s.hide(),n=o.find(".document_count_inner"),n.html(parseInt(n.html(),0)+parseInt(e.folder.doc_count,0)),r=$("<span>").addClass("update").html("+"+e.folder.doc_count).css("opacity",1),a.append(r),r.animate({opacity:0},{duration:1200,done:function(){return t.crossFadeUpdateAndDocumentCounts(r,o)}}),setTimeout(function(){return t.removeMovedItemsFromView(e),update_jump_folder_count(e),update_user_util_counts(e.folder.doc_count,e.folder.slug,!1)},2400)}}(this))):void 0},e.prototype.displayNewFolderModal=function(){var t;return t=Handlebars.compile($("#new-folder-modal-template").html()),FR2.Modal.displayModal("",t(),{includeTitle:!1,modalClass:"new-folder-modal"}),$("body").on("folderCreated","#fr_modal",this.runFolderCreationHandler),this.folderHandler=new FR2.ClippingsFolderHandler($("#fr_modal.new-folder-modal"),this.clippingIds())},e.prototype.displayAccountNeededModal=function(){var t,e,n;return t=Handlebars.compile($("#account-needed-modal-template").html()),n={redirect_to:window.location.href},e="/auth/sign_in?"+$.param(n),FR2.Modal.displayModal("",t({redirectUrl:e}),{includeTitle:!1}),this.addModalClosedHandler()},e.prototype.addModalClosedHandler=function(){return $("body").on("modalClose","#fr_modal",this.rebindAndCloseClippingMenu)},e.prototype.rebindAndCloseClippingMenu=function(){var t;return $("body").off("modalClose","#fr_modal",this.rebindAndCloseClippingMenu),t=this,this.actionBar.on("mouseleave",".add-to-folder",function(){return t.hideMenu(this)}),t.hideMenu(this.actionBar.find(".add-to-folder")),this.actionBar.find(".add-to-folder .menu li#new-folder").removeClass("hover")},e.prototype.runFolderCreationHandler=function(t,e){return update_user_folder_and_document_count(e),$("body").off("folderCreated","#fr_modal",this.runFolderCreationHandler),this.addNewFolderToMenus(e),setTimeout(function(t){return function(){return t.removeMovedItemsFromView(e),update_user_util_counts(e.folder.doc_count,e.folder.slug,!0)}}(this),2400)},e.prototype.addNewFolderToMenus=function(t){var e,n,o,r,i,a;return i=Handlebars.compile($("#add-to-folder-menu-li-template").html()),o=$(i(t)),r=o.clone(),r.find("a").attr("href","/my/folders/"+t.folder.slug),this.actionBar.find(".jump-to-folder .menu ul").append(r),this.actionBar.find(".add-to-folder .menu ul").append(o.css("opacity",0)),n=o.find("a"),e=n.find(".document_count"),a=$("<span>").addClass("update").html("+"+t.folder.doc_count).css("opacity",1),e.css("opacity",0),n.append(a),o.animate({opacity:1},{duration:1200,done:function(t){return function(){return t.crossFadeUpdateAndDocumentCounts(a,e)}}(this)})},e.prototype.crossFadeUpdateAndDocumentCounts=function(t,e){return t.animate({opacity:0},600),e.animate({opacity:1},{duration:1200,done:function(t){return function(){return t.rebindAndCloseClippingMenu()}}(this)})},e.prototype.removeMovedItemsFromView=function(t){return _.each(t.folder.documents,function(t){return $("#clippings li[data-doc-id='"+t+"']").animate({opacity:0},{duration:600,done:function(){return this.remove()}})}),update_clippings_on_page_count(t.folder.doc_count),update_current_folder_page_counts(t.folder.doc_count)},e}()}.call(this),function(){this.FR2.SubscriptionFilter=function(){function t(t,e){this.actionBar=$(t),this.subscriptionTypeFilters=e,this.init(),this.addEvents()}return t.prototype.init=function(){return _.each($(".subscription-type-filter li"),function(t){return _.include(subscriptionTypeFilters,$(t).data("filter-doc-type"))?($(t).addClass("on"),$(t).data("tooltip","Hide "+$(t).data("filter-doc-type-display")+" subscriptions")):$(t).addClass("disabled")})},t.prototype.addEvents=function(){var t,e;return e=this,t=this.actionBar.find(".subscription-type-filter"),t.on("mouseenter","li:not(.disabled)",function(){return $(this).addClass("hover")}),t.on("mouseleave","li:not(.disabled)",function(){return $(this).removeClass("hover")}),t.on("click","li:not(.disabled)",function(){return e.filterSubscriptionsByType($(this))}),t.find("li:not(.disabled)").tipsy({gravity:"s",fade:!0,offset:2,title:function(){return $(this).data("tooltip")}})},t.prototype.filterSubscriptionsByType=function(t){var e;return e=t.data("filter-doc-type"),t.hasClass("on")?this.filterOff(t):this.filterOn(t),this.toggleSubscriptions(e)},t.prototype.filterOn=function(t){return t.addClass("on"),t.data("tooltip","Hide "+t.data("filter-doc-type-display")+" subscriptions"),t.tipsy("hide"),t.tipsy("show")},t.prototype.filterOff=function(t){return t.removeClass("on"),t.removeClass("hover"),t.data("tooltip","Show "+t.data("filter-doc-type-display")+" subscriptions"),t.tipsy("hide"),t.tipsy("show")},t.prototype.toggleSubscriptions=function(t){var e;return e=_.filter($(".subscriptions li"),function(e){return t===$(e).data("doc-type")}),$(e).toggle()},t}()}.call(this),function(){}.call(this),function(){$(document).ready(function(){return $("#main").on("click","a.fr_modal, a.fr_modal_link",function(t){var e,n,o,r,i;return t.preventDefault(),e=$(this),i=e.data("modal-title"),r=$("#"+e.data("modal-template-name")),n=e.data("modal-data"),o="",o=r.length>0?Handlebars.compile(r.html())(n):e.data("modal-html"),FR2.Modal.displayModal(i,o)})})}.call(this),function(){this.FR2.FormUtils=function(){function t(){}return t.enforceCharactersRemaining=function(t){var e;return e=$(t).find($(t).hasClass("text")?"textarea":"input"),this.updateCharacterCount(e),this.visuallyNotifyUser(e)},t.charactersRemaining=function(t){var e,n,o,r;return e=$(t),n=e.closest("li"),o=n.data("max-size"),r=0,null!=e.val()&&""!==e.val()&&(r=e.val().length),o-r},t.addCharCountError=function(t){var e,n,o;return e=$(t),n=e.closest("li"),o=n.data("size-warn-at"),(n.hasClass("string")||n.hasClass("text"))&&null!=o?this.charactersRemaining(t)<=o:!1},t.updateCharacterCount=function(t){var e,n,o,r;return e=$(t),n=e.siblings("p.inline-errors").first(),o=this.charactersRemaining(e),r=this.remaining_string(o),this.addCharCountError(e)?(0===n.length&&(e.after($("<p>").addClass("inline-errors")),n=e.siblings("p.inline-errors").first()),n.text(r)):0!==n.length?n.text("").remove():void 0},t.remaining_string=function(t){var e;return 1===t?e=" character left":t>1||0===t?e=" characters left":-1===t?e=" character over limit":-1>t&&(e=" characters over limit"),Math.abs(t)+e},t.visuallyNotifyUser=function(t){var e,n,o,r;return e=$(t),o=e.closest("li"),r=this.charactersRemaining(e),n=e.siblings("p.inline-errors").first(),0>r?o.addClass("error"):o.removeClass("error"),r>=0?n.addClass("warning"):n.removeClass("warning")},t.validateField=function(t){var e,n;return e=$(t),n=e.find("input"),null!=n&&null!=n.val()&&!this.addCharCountError(n)&&n.val().length>0?e.removeClass("error").find("p.inline-errors").text(""):void 0},t}()}.call(this),$(document).ready(function(){$("#subscriptions li").each(function(){var t=$(this),e=t.find(".search_data").height();t.find(".subscription_data").height(e)}),$("#subscriptions").delegate(".subscription_data a.unsubscribe","click",function(t){t.preventDefault();var e=$(this);$.ajax({url:e.attr("href"),type:"GET",dataType:"json",success:function(t){unsubscribe_success(e,t)},error:function(){}})}),$("#subscriptions").delegate(".subscription_data a.resubscribe","click",function(t){t.preventDefault();var e=$(this);$.ajax({url:e.attr("href"),type:"GET",dataType:"json",success:function(t){resubscribe_success(e,t)},error:function(){}})}),$("#subscriptions").delegate(".subscription_data a.confirm-subscription-destroy-js","click",function(t){t.preventDefault();var e=$(this),n="<a data-subscription-id='"+e.data("subscription-id")+"' class='fr_button medium primary destroy-js' href='"+e.attr("href")+"'>Delete</a>";FR2.Modal.displayModal("Please Confirm Deletion","<p>Are you sure you would like to delete this subscription? This can not be undone.</p>"+n)}),$("#subscriptions").on("click","a.destroy-js",function(t){t.preventDefault();var e=$(this);$.ajax({url:e.attr("href"),type:"DELETE",dataType:"json",success:function(t){destroy_subscription_success(e,t)},error:function(){}})})}),$(document).ready(function(){var t=new EmailHelper;$("form").on("click",".email_suggestion .link",function(){t.use_suggestion($(this))}),$("form#new_user").on("blur","#user_email",function(){var e=$(this);t.initialized||t.initialize(e),t.validate_or_suggest()}),$("form #user_email").on("blur",function(){var e=$(this);t.initialized||t.initialize(e),t.validate_or_suggest()}),$("form#password_reset").on("input onpropertychange","#user_email",function(){var e=$(this);clearTimeout(e.data("timeout")),t.initialized||t.initialize(e),t.reset_help_text(),e.data("timeout",setTimeout(function(){t.validate_or_suggest()},500))}),$("form#new_user").on("submit",function(t){var e=$(t.target).find("input#registration_btn");e.attr("disabled",!0),setTimeout(function(){e.closest("ol").find(".loader").css("display","inline-block"),e.parent().hide()},250)})}),function(){this.FR2.CommentForm=function(){function t(t,e){this.commentFormId=t,this.commentFormHandler=e,this.notSentFieldIds=["#comment_confirmation_text","#comment_confirm_submission_input"],this.uploadsInProgress=!1}return t.prototype.initialize=function(){return this.addFormEvents(),this.addCommentSecret(),this.setSubmitButtonState(),this.addSubmitButtonWarningModal()},t.prototype.commentFormEl=function(){return null===this._commentFormEl||void 0===this._commentFormEl||this._commentFormEl===[]?$(this.commentFormId):this._commentFormEl},t.prototype.commentFormFileUploader=function(){return this.commentFormHandler.commentFormFileUploader},t.prototype.addFormEvents=function(){return this.comboBoxChangeHandler(),this.removeErrorsOnChange(),this.maxCharacterWarning(),this.confirmCommentSubmission(),this.formSubmit()},t.prototype.parseFields=function(){var t,e;return e=[],t=this.commentFormEl().find(".inputs > ol > li"),t=this.removeNotSentFields(t),_.each(t,function(t){return function(n){var o,r,i,a,s,l;return l=$(n),s=l.find("label").text().replace("*",""),i={label:s},l.hasClass("combo")?(a=l.find("select").first(),i.values=Array(a.length>0?t.getOptionValue(a):t.getItemValue(l,"input"))):l.hasClass("stringish")?i.values=Array(t.getItemValue(l,"input")):l.hasClass("text")?i.values=Array(t.getItemValue(l,"textarea")):l.hasClass("select")?(a=l.find("select").first(),i.values=Array(t.getOptionValue(a))):l.hasClass("file")&&(r=l.find(".attachments tr"),o=_.map(r,function(t){return $(t).data("name")}),o.length?i.values=o:Array("None attached")),e.push(i)}}(this)),e},t.prototype.removeNotSentFields=function(t){return _.each(this.notSentFieldIds,function(e){return t=t.filter("li:not("+e+")")}),t},t.prototype.getOptionValue=function(t){return t.find('option[value="'+t.val()+'"]').first().text()},t.prototype.getItemValue=function(t,e){return t.find(e).val()},t.prototype.comboBoxChangeHandler=function(){return _.each(this.commentFormEl().find("li.combo"),function(t){return function(e){var n,o,r;return n=$(e),o=n.data("dependencies"),r=n.find("input"),t.commentFormEl().find("select[name='comment["+n.data("dependent-on")+"]']").change(function(){var t,e,i,a;return e=$(this),i=e.val(),n.find("select").remove(),o[i]?(t=r.val(),a=$("<select name='"+r.attr("name")+"'><option></option></select>"),_.map(o[i],function(t){var e;return e=$("<option>"),e.attr("value",t[0]).text(t[1]),a.append(e)}),a.val(t),r.prop("disabled",!0).hide().val("").after(a)):r.prop("disabled",!1).show()}).change()}}(this))},t.prototype.addCommentSecret=function(){var t;return t=this.commentFormEl().find("#comment_secret"),""===t.val()?t.val(Math.random().toString(36).substring(2,16)):void 0},t.prototype.removeErrorsOnChange=function(){return this.commentFormEl().on("change","select",function(){var t;return t=$(this),t.siblings(".inline-errors").remove(),t.closest("li").removeClass("error")}),this.commentFormEl().on("change keyup","li.error.input",function(){return FR2.FormUtils.validateField(this)})},t.prototype.maxCharacterWarning=function(){return this.commentFormEl().on("change keyup","li.input[data-max-size]",function(){return FR2.FormUtils.enforceCharactersRemaining(this)})},t.prototype.submitButtonWrapper=function(){return this.commentFormEl().find(".button.commit")},t.prototype.commentConfirmationCheckbox=function(){return this.commentFormEl().find("#comment_confirm_submission")},t.prototype.confirmCommentSubmission=function(){return this.commentFormEl().on("change",this.commentConfirmationCheckbox(),function(t){return function(){return t.setSubmitButtonState()}}(this))},t.prototype.setSubmitButtonState=function(){return this.commentConfirmationChecked()&&this.uploaderReady()?this.enableSubmitButton():this.disableSubmitButton()},t.prototype.commentConfirmationChecked=function(){return this.commentConfirmationCheckbox().is(":checked")},t.prototype.formSubmit=function(){return this.commentFormEl().on("click",".button.commit:not(.submitting, .disabled)",function(t){return function(e){return e.preventDefault(),t.commentFormHandler.submitCommentForm()}}(this))},t.prototype.storeComment=function(){return this.commentFormHandler.storeComment()},t.prototype.enableSubmitButton=function(){return this.submitButtonWrapper().removeClass("disabled").find("input").prop("disabled",!1),this.submitButtonWrapper().find(".event-overlay").remove()},t.prototype.disableSubmitButton=function(){var t;return this.submitButtonWrapper().addClass("disabled").find("input").prop("disabled",!0),t=this.submitButtonWrapper().find(".event-overlay"),0===t.length?(t=$("<div>").addClass("event-overlay"),t.css({position:"absolute",top:0,left:0,width:this.submitButtonWrapper().outerWidth(),height:this.submitButtonWrapper().outerHeight(),zIndex:2e3,backgroundColor:"#FFF",opacity:0}).on("click",function(t){return function(e){return e.preventDefault(),e.stopPropagation(),t.submitButtonWrapper().trigger("click")}}(this)),this.submitButtonWrapper().append(t)):void 0},t.prototype.uploaderReady=function(t){return null!=t&&(this.uploaderReadyStatus=t,this.setSubmitButtonState()),this.uploaderReadyStatus},t.prototype.getSubmitButtonState=function(){return this.uploaderReady()?this.commentConfirmationChecked()?!1:"Please read and confirm the statement regarding the submission of personal information.":this.commentFormFileUploader().uploaderHasErrors()?"Some of your files have errors. Please remove the files and try again.":this.commentFormFileUploader().uploaderInProgress()?"Your files are still being uploaded. Please wait until they are complete and try again.":void 0},t.prototype.addSubmitButtonWarningModal=function(){return this.submitButtonWrapper().on("click",function(t){return function(e){var n,o;return t.submitButtonWrapper().hasClass("disabled")?(e.preventDefault(),e.stopPropagation(),o="Unable to Submit Comment",n=t.getSubmitButtonState(),FR2.Modal.displayModal(o,n)):void 0}}(this))},t}()}.call(this),function(){FR2.currentUserStorage=new FR2.NonPersistentStorage,$(document).ready(function(){var t,e,n;return n=new FR2.UserData,new FR2.UserNavigationManager(n),CJ.Tooltip.addTooltip(".cj-tooltip",{offset:5,opacity:.9,delay:.3,fade:!0}),_.each($(".toggle"),function(t){return new CJ.ToggleOne(t)}),_.each($(".toggle-all"),function(t){return new CJ.ToggleAll(t)}),e=$(".calendar-wrapper:not(.cal-double) table.calendar"),_.each(e,function(t){return new FR2.Calendar($(t))}),t=$(".calendars-wrapper"),_.each(t,function(t){return new FR2.MultiCalendarHandler($(t).find("table.calendar"))}),$("#comment-bar.comment").on("click",".button.formal_comment.how_to_comment",function(){var t,e,n,o;return e=$(this),n="Comment: How to Comment",t=e.attr("href"),o=e.closest("div.comment").data("document-number"),FR2.Analytics.trackGAEvent(n,t,o)}),$("a.rss, a.subscription, a.subscription_action").not(".no-modal-action").on("click",function(t){return t.preventDefault(),FR2.SubscriptionHandler.generateModal()}),FR2.documentClippers=[],_.each($(".document-clipping-actions"),function(t){return FR2.documentClippers.push(new FR2.DocumentClipper(t))}),$(".logo").siblings("div#user_utils").length>0&&$(".logo .hgroup").css("position","relative").css("top","20px"),$("body").on("click","a:not(.formal_comment)",function(t){return new FR2.ExternalLinkChecker(t)}),$(".clipboard-copy").length>0&&$(".clipboard-copy").on("click",function(){var t,e;return t=new FR2.Clipboard,e="Shorter document URL copied to clipboard",t.copyToClipboard($(this).data("clipboardText")),$(".tipsy .tipsy-inner").text(e)}),$(".table-modal-js").length>0?$(".table-modal-js").on("click",function(){return new FR2.TableModalHandler(this)}):void 0})}.call(this),function(){this.FR2.CommentFormFileUploader=function(){function t(t){this.commentFormHandler=t}return t.ATTACHED_COMMENT_MESSAGE="See attached file(s)",t.prototype.initialize=function(){return this.attachUploader(),this.addCompleteEvents(),this.addUploadEvents(),this.addDestroyEvents(),this.displayExistingAttachments(),this.displayAttachmentErrors(),this.commentForm().uploaderReady(!0)},t.prototype.commentForm=function(){return this.commentFormHandler.commentForm},t.prototype.commentFormEl=function(){return this.commentForm().commentFormEl()},t.prototype.commentField=function(){return this.commentFormEl().find("#comment_general_comment")},t.prototype.attachmentContainer=function(){return this.commentFormEl().find(".attachments tbody")},t.prototype.existingAttachments=function(){return this.commentFormEl().find(".attachments").data("existing")},t.prototype.attachedCommentMessage=function(){return this.constructor.ATTACHED_COMMENT_MESSAGE},t.prototype.attachUploader=function(){return this.uploaderEl=$(this.commentFormEl().find("#fileupload")),this.uploader=this.uploaderEl.fileupload({url:"/my/comment_attachments.json",autoUpload:!0,dataType:"json",processQueue:[{action:"validate",always:!0,acceptFileTypes:/(\.|\/)(bmp|xls|pdf|gif|jpg|jpeg|png|ppt|rtf|sgml|tiff|tif|txt|wpd|xml|docx|xlsx|pptx)$/i,maxFileSize:10485760,maxNumberOfFiles:10}],formData:{"comment_attachment[secret]":$("#comment_secret").val(),authenticity_token:this.commentFormEl().find("input[name=authenticity_token]").val()},filesContainer:this.attachmentContainer(),uploadTemplateId:null,downloadTemplateId:null,uploadTemplate:function(t){var e,n;return e=$("#comment-attachment-upload-template").html(),(n=Handlebars.compile(e))(t)},downloadTemplate:function(t){var e,n;return e=$("#comment-attachment-complete-template").html(),(n=Handlebars.compile(e))(t)}}).data("blueimpFileupload")},t.prototype.attachmentEl=function(){return $(".attachments tbody")},t.prototype.filesUploading=function(){return this.attachmentEl().find(".template-upload").not(".error").length>0},t.prototype.filesWithErrors=function(){return this.attachmentEl().find(".template-upload.error").length>0},t.prototype.uploaderInProgress=function(){return this.filesUploading()},t.prototype.uploaderHasErrors=function(){return this.filesWithErrors()},t.prototype.uploaderReady=function(){return!this.uploaderInProgress()&&!this.uploaderHasErrors()},t.prototype.updateUploaderStatus=function(t){return"submit"===t||"fail"===t?this.commentForm().uploaderReady(!1):"complete"!==t&&"destroy"!==t||!this.uploaderReady()?void 0:this.commentForm().uploaderReady(!0)},t.prototype.addUploadEvents=function(){return this.uploaderEl.bind("fileuploadsubmit",function(t){return function(){return t.updateUploaderStatus("submit"),!0}}(this)),this.uploaderEl.bind("fileuploadprocessfail",function(t){return function(e,n){return t.updateUploaderStatus("fail"),n.files.error?_.each(n.context,function(t,e){var o,r;return r=n.files[e].error,o=$(t),r?(o.closest("tr").addClass("error"),o.find(".progress-bar").html(r),o.find(".button.cancel .action").text("Delete")):void 0}):void 0}}(this)),this.uploaderEl.bind("fileuploadfail",function(t){return function(){return t.updateUploaderStatus("destroy")}}(this))},t.prototype.addCompleteEvents=function(){return this.uploaderEl.bind("fileuploadcompleted",function(t){return function(){return""===t.commentField().val()&&t.commentField().val(t.attachedCommentMessage()),t.commentForm().storeComment(),t.updateUploaderStatus("complete")}}(this))},t.prototype.addDestroyEvents=function(){return this.uploaderEl.bind("fileuploaddestroyed",function(t){return function(){return t.clearCommentPlaceholder(),t.updateUploaderStatus("destroy")}}(this))},t.prototype.clearCommentPlaceholder=function(){return this.commentField().val()===this.attachedCommentMessage()&&0===this.attachmentContainer().children("tr:not(.error)").length?this.commentField().val(""):void 0},t.prototype.displayExistingAttachments=function(){return this.uploader._renderDownload(this.existingAttachments()).appendTo(this.attachmentContainer()),this.clearCommentPlaceholder()},t.prototype.displayAttachmentErrors=function(){var t,e;return e=this.uploader._hasError,t=this,this.uploader._hasError=function(n){return _.each(t.attachmentContainer().find("tr"),function(t,e){var o;return o=$(e),o.data("name")===n.name?n.error="A file with the same name has already been attached.":void 0}),e.call(this,n)}},t}()}.call(this),function(){this.FR2.CommentFormHandler=function(){function t(t){this.formWrapper=t,this.commentFormStore=new FR2.CommentFormStore(this),this.commentFormLoadHandler=new FR2.CommentFormLoadHandler(this),this.commentFormSubmissionHandler=new FR2.CommentFormSubmissionHandler(this),this.commentFormFileUploader=new FR2.CommentFormFileUploader(this),this.commentFormSuccessHandler=new FR2.CommentFormSuccessHandler(this),this.startComment(),"#open-comment"===window.location.hash&&this.openCommentFromUrlHash()}return t.prototype.commentFormReady=function(){return this.removeEvents(),this.commentForm.initialize(),this.commentFormFileUploader.initialize(),this.commentFormStore.addStorageEvents(),this.addEvents(),this.decorate(),this.refreshDocStickyNav()},t.prototype.successPageReady=function(){return this.commentFormSuccessHandler.initialize(),this.refreshDocStickyNav()},t.prototype.removeEvents=function(){return this.formWrapper.unbind()},t.prototype.addEvents=function(){return this.previewComment(),this.startCommentOver()},t.prototype.decorate=function(){return this.addPublicIcons(),this.addTooltipToPublicIcons(),this.improveUploadButton()},t.prototype.commentFormEl=function(){return this.commentForm.commentFormEl()},t.prototype.refreshDocStickyNav=function(){return $(".doc-document ul.doc-nav").sticky("refresh")},t.prototype.previewComment=function(){return this.commentFormEl().on("click",".comment_preview",function(t){return function(e){var n,o,r,i,a,s,l,c,u;return e.preventDefault(),o=t.commentForm.parseFields(),r=t.renderCommentSummary(o),Handlebars.registerPartial("comment_summary",$("#comment-summary-template").html()),l="Preview your comment",s=$("#comment-summary-template"),i=o,n=Handlebars.compile(s.html()),a=n({fields:i}),c=$("#comment-summary-template").html(),u=Handlebars.compile(c),FR2.Modal.displayModal(l,a,{modalClass:"comment-preview-modal"})}}(this))},t.prototype.renderCommentSummary=function(t){var e,n;return e=$("#comment-summary-template").html(),(n=Handlebars.compile(e))(t)},t.prototype.addPublicIcons=function(){var t;return t=this.commentFormEl().find(".inputs li"),_.each(t,function(t){var e,n,o;return e=$(t),e.hasClass("public")?(n=e.find(" > :input").last(),o="comment_general_comment"===n.prop("id")||"fileupload"===n.prop("id")?"e":"w",n.after($("<span>").addClass("public icon-fr2 icon-fr2-globe").data("tooltip-gravity",o))):void 0})},t.prototype.addTooltipToPublicIcons=function(){return _.each(this.commentFormEl().find(".inputs span.public"),function(t){var e,n,o,r;return t=$(t),n=t.siblings("input").data("tooltip"),null!=n?t.data("tooltip",n):t.data("tooltip","Information entered in this field will be publically viewable on Regulations.gov"),e="form-tooltip "+t.siblings("input").prop("type"),r="e"===t.data("tooltip-gravity")?"centerLeft":"centerRight",o="e"===t.data("tooltip-gravity")?-10:5,CJ.Tooltip.addFancyTooltip($(t),{fade:!0,className:e,opacity:1},{horizontalOffset:o,position:r,verticalOffset:-5})})},t.prototype.fileUploadButton=function(){return this.commentFormEl().find("#fileupload")},t.prototype.fileUploadButtonWrapper=function(){return this.commentFormEl().find(".fileupload-button")},t.prototype.improveUploadButton=function(){var t;return t=$("<div>"),t.addClass("add_file button").text("Add a file").prepend($("<span>").addClass("icon-fr2 icon-fr2-add")),this.fileUploadButtonWrapper().append(t),this.fileUploadButton().on("hover",function(){return function(){return t.toggleClass("hover")}}(this))},t.prototype.loadCommentForm=function(){return this.commentFormLoadHandler.load()},t.prototype.openCommentFromUrlHash=function(){var t,e,n;return t=this.formWrapper.find("a#start_comment[data-comment=1]").get(0),t?$(t).trigger("click"):(n="Comment Submission Not Available",e="This document is not open for comment or is not available for comment submission on FederalRegister.gov. You may want to check the DATES, ADDRESSES, or FOR FURTHER INFORMATION CONTACT sections of this document.",FR2.Modal.displayModal(n,e))},t.prototype.submitCommentForm=function(){return this.commentFormStore.storeComment(),this.trackCommentFormSubmitStart(),this.commentFormSubmissionHandler.submit()},t.prototype.startComment=function(){return this.formWrapper.on("click","a#start_comment[data-comment=1]",function(t){return function(e){return e.preventDefault(),window.location.hash="#open-comment",t.trackCommentFormOpenStart(),t.loadCommentForm()}}(this))},t.prototype.trackCommentFormOpenStart=function(){return this.trackCommentEvent("Comment: Open Comment Form Start")},t.prototype.trackCommentFormStartOver=function(){return this.trackCommentEvent("Comment: Comment Form Start Over")},t.prototype.trackCommentFormSubmitStart=function(){return this.trackCommentEvent("Comment: Submit Comment Form Start")},t.prototype.trackCommentEvent=function(t){var e,n,o;return o=$("#comment-bar"),e=o.data("reggov-agency"),n=o.data("document-number"),FR2.Analytics.trackCommentEvent(t,e,n)},t.prototype.startCommentOver=function(){return this.commentFormEl().on("click","a#comment-start-over",function(t){return function(e){var n,o;return e.preventDefault(),t.trackCommentFormStartOver(),t.commentFormStore.clearSavedFormState(),n=$(".ajax-comment-data"),o=n.find(".comment_wrapper"),n.animate({height:"42px"},400),n.scrollintoview({duration:400}),o.slideUp(400,function(){return o.remove(),t.loadCommentForm()})}}(this))},t.prototype.updateCommentHeader=function(){var t,e;return e=$("#comment-bar.comment p"),t=this,e.find(".button").fadeOut(400,function(){return e.closest("div").addClass("open"),e.html(Handlebars.compile($("#new-comment-byline-template").html())({commentDueDate:$(".comment_form_wrapper").data("comment-due")})),e.find("#close-comment-form").on("click",function(e){return e.preventDefault(),window.location.hash="",t.closeCommentForm()})})},t.prototype.closeCommentForm=function(){var t,e;return t=$(".ajax-comment-data"),e=t.find(".comment_wrapper"),t.animate({height:"42px"},400),t.scrollintoview({duration:500}),e.slideUp(400,function(n){return function(){return e.remove(),t.html("").hide(),n.resetCommentHeader(),n.refreshDocStickyNav()}}(this))},t.prototype.resetCommentHeader=function(){var t,e;return t=$("#comment-bar"),e={commentPeriodOpen:t.data("comment-period-open"),commentDaysRemaining:t.data("comment-days-remaining"),commentsCloseOn:t.data("comments-close-on"),reggovCommentUrl:t.data("reggov-comment-url")},$("#comment-bar.comment p").replaceWith(Handlebars.compile($("#comment-header-template").html())(e)),t.height("inherit"),new FR2.CommentFormHandler(t)},t.prototype.storeComment=function(){return this.commentFormStore.storeComment()},t.prototype.addStorageEvents=function(){return this.commentFormStore.addStorageEvents()},t}()}.call(this),function(){this.FR2.CommentFormLoadHandler=function(){function t(t){this.commentFormHandler=t,this.commentFormStore=this.commentFormHandler.commentFormStore,this.setup()}return t.prototype.formWrapper=function(){return this.commentFormHandler.formWrapper},t.prototype.commentLink=function(){return this.formWrapper().find("a#start_comment")},t.prototype.ajaxCommentData=function(){return $(".ajax-comment-data")},t.prototype.setup=function(){return this.commentDiv=$("<div>").addClass("ajax-comment-data").hide(),this.loadingDiv=$("<div>").addClass("loading").append($("<span>").addClass("loader").html("Loading Comment Form").append($("<span>").addClass("spinner"))),this.documentNumber=this.formWrapper().data("document-number"),this.formWrapper().after(this.commentDiv)
},t.prototype.uiTriggerLoading=function(){return this.commentDiv.append(this.loadingDiv),this.commentDiv.slideDown(800),this.commentFormHandler.refreshDocStickyNav()},t.prototype.generateAjaxOptions=function(){return this.ajaxOptions=this.commentFormStore.hasStoredComment()?{url:"/my/documents/"+this.documentNumber+"/comments/reload.html",type:"POST",data:this.commentFormStore.getStoredComment()}:{url:"/my/documents/"+this.documentNumber+"/comments/new"}},t.prototype.load=function(){return this.uiTriggerLoading(),this.generateAjaxOptions(),this.loadForm()},t.prototype.loadForm=function(){var t,e;return e={url:"",dataType:"html",type:"GET",data:"",timeout:3e4},t=this,$.extend(e,this.ajaxOptions),$.ajax({url:e.url,type:e.type,dataType:e.dataType,data:e.data,timeout:e.timeout,success:function(e){return t.success(e)},error:function(e){return t.error(e)}})},t.prototype.trackCommentFormOpenSuccess=function(){return this.commentFormHandler.trackCommentEvent("Comment: Open Comment Form Success")},t.prototype.trackCommentFormOpenError=function(t){return this.commentFormHandler.trackCommentEvent("Comment: Open Comment Form "+t)},t.prototype.success=function(t){var e;return this.generateCommentForm(t),e=this.commentFormWrapper,this.loadingDiv.fadeOut(600,function(t){return function(){var n;return t.commentFormHandler.updateCommentHeader(),n=t.ajaxCommentData(),n.css("height","42px").animate({height:e.css("height")},800,function(){return n.css("height","auto")}),e.slideDown(800,function(){return t.commentFormHandler.commentFormReady(),t.addTrackingEvents(),t.trackCommentFormOpenSuccess()})}}(this))},t.prototype.error=function(t){var e,n,o,r,i;return"1"===t.getResponseHeader("Regulations-Dot-Gov-Problem")||"1"===t.getResponseHeader("Comments-No-Longer-Accepted")||"1"===t.getResponseHeader("Regulations-Dot-Gov-Over-Rate-Limit")?(r=JSON.parse(t.responseText),n=r.modalTitle,e=r.modalHtml,"1"===t.getResponseHeader("Regulations-Dot-Gov-Problem")?this.trackCommentFormOpenError("Regulations.gov Error"):"1"===t.getResponseHeader("Comments-No-Longer-Accepted")?this.trackCommentFormOpenError("Comments No Longer Accepted Error"):"1"===t.getResponseHeader("Regulations-Dot-Gov-Over-Rate-Limit")&&this.trackCommentFormOpenError("Over Rate Limit Error"),i="",$.ajax({async:!1,url:"/api/v1/site_notifications/comment",dataType:"json",success:function(t){return t.active?i="<div class='"+t.notification_type+"'>"+t.description+"</div>":void 0}}),e=i+" "+e):(o=this.formWrapper().data("reggov-comment-url"),n="We're sorry something <br> went wrong",e="<p>We're sorry we are currently unable to submit your comment to Regulations.gov.</p> <p> You may want try again in a few moments or attempt to comment via Regulations.gov: <br> <a href='"+o+"'>"+o+"</a>, <br>or via any other method described in the document. </p>",this.trackCommentFormOpenError("FederalRegister.gov Error"),i="",$.ajax({async:!1,url:"/api/v1/site_notifications/comment",dataType:"json",success:function(t){return t.active?i="<div class='"+t.notification_type+"'>"+t.description+"</div>":void 0}}),e=i+" "+e),FR2.Modal.displayModal(n,e),$(".ajax-comment-data").fadeOut(600)},t.prototype.generateCommentForm=function(t){return this.commentFormWrapper=$("<div>").addClass("comment_wrapper").html(t).hide(),this.commentDiv.append(this.commentFormWrapper),this.commentFormHandler.commentForm=new FR2.CommentForm("#new_comment",this.commentFormHandler),this.commentForm=this.commentFormHandler.commentForm,this.commentFormHandler.addStorageEvents()},t.prototype.addTrackingEvents=function(){return this.ajaxCommentData().on("click",".reg_gov_comment_tips",function(t){return function(){return t.commentFormHandler.trackCommentEvent("Comment Instructions: Regulations.gov Comment Tips")}}(this)),this.ajaxCommentData().on("click",".reg_gov_posting_guidelines",function(t){return function(){return t.commentFormHandler.trackCommentEvent("Comment Instructions: Regulations.gov Agency Posting Guidelines Modal")}}(this)),this.ajaxCommentData().on("click",".reg_gov_alternative_ways_to_comment",function(t){return function(){return t.commentFormHandler.trackCommentEvent("Comment Instructions: Regulations.gov Alternative Ways to Comment Modal")}}(this)),this.ajaxCommentData().on("click",".alternative_ways_to_comment.addresses",function(t){return function(){return t.commentFormHandler.trackCommentEvent("Comment Instructions: FederalRegister.gov Alternative Ways to Comment")}}(this)),this.ajaxCommentData().on("click",".comment_preview",function(t){return function(){return t.commentFormHandler.trackCommentEvent("Comment Form: Comment Preview Modal")}}(this)),this.ajaxCommentData().on("click","#comment-privacy-policy",function(t){return function(){return t.commentFormHandler.trackCommentEvent("Comment Footer: Regulations.gov Privacy Policy")}}(this)),this.ajaxCommentData().on("click","#comment-user-notice",function(t){return function(){return t.commentFormHandler.trackCommentEvent("Comment Footer: Regulations.gov User Notice")}}(this)),this.ajaxCommentData().on("click",".attachment_requirements",function(t){return function(){return t.commentFormHandler.trackCommentEvent("Comment Instructions: Regulations.gov Attachment Requirements Modal")}}(this))},t}()}.call(this),function(){this.FR2.CommentFormStore=function(){function t(t){this.commentFormHandler=t,this.recentlySaved=!1,this.saveTimeoutDuration=5e3,this.saveTimeout=null}return t.prototype.commentFormEl=function(){return this.commentFormHandler.commentForm.commentFormEl()},t.prototype.documentNumber=function(){return this.commentFormHandler.formWrapper.data("document-number")},t.prototype.getStoredComment=function(){return amplify.store(this.documentNumber())},t.prototype.setStoredComment=function(t){return""===t&&(t=null),amplify.store(this.documentNumber(),t)},t.prototype.hasStoredComment=function(){return null!=this.getStoredComment()},t.prototype.addStorageEvents=function(){return this.commentFormEl().on("keyup change",":input",function(t){return function(){var e;return t.recentlySaved||null!==t.saveTimeout?void 0:(t.recentlySaved=!0,e=function(){return t.setStoredComment(t.serializeForm()),t.recentlySaved=!1,t.saveTimeout=null},t.saveTimeout=setTimeout(e,t.saveTimeoutDuration))}}(this))},t.prototype.serializeForm=function(){var t,e;return e=this.commentFormEl().find(":input"),e=e.filter(":input[name!=authenticity_token]").filter(":input[name!=utf8]").filter(':input[name!="comment[confirm_submission]"]').filter(':input[name!="commit"]'),t=_.filter(e,function(t){return""!==$(t).val()}),$(t).serialize()},t.prototype.clearSavedFormState=function(){return this.setStoredComment(null)},t.prototype.storeComment=function(){return this.setStoredComment(this.serializeForm())},t}()}.call(this),function(){this.FR2.CommentFormSubmissionHandler=function(){function t(t){this.commentFormHandler=t}return t.prototype.commentFormStore=function(){return this.commentFormHandler.commentFormStore},t.prototype.commentForm=function(){return this.commentFormHandler.commentForm},t.prototype.commentFormEl=function(){return this.commentForm().commentFormEl()},t.prototype.submitButton=function(){return this.commentFormEl().find(".commit.button")},t.prototype.submit=function(){return this.styleSubmitButton(),this.submitForm()},t.prototype.styleSubmitButton=function(){return this.submitButton().addClass("submitting").find("input").prop("disabled",!0).attr("value","Submitting Comment")},t.prototype.submitForm=function(t){var e,n,o,r;return o={url:this.commentFormEl().attr("action"),dataType:"html",type:"POST",data:this.commentFormEl().serialize()},e=this.commentFormEl().data("agency"),n=this.commentFormEl().data("document-number"),r=this,$.extend(o,t),$.ajax({url:o.url,type:o.type,dataType:o.dataType,data:o.data,success:function(t){return r.success(t),r.trackCommentFormSubmissionSuccess()},error:function(t){return r.trackCommentFormSubmissionError(422===t.status?"Comment: Submit Comment Form Validation Error":"Comment: Submit Comment Form Error "+t.error),r.error(t)}})},t.prototype.trackCommentFormSubmissionSuccess=function(){return this.commentFormHandler.trackCommentEvent("Comment: Submit Comment Form Success")},t.prototype.trackCommentFormSubmissionError=function(t){return this.commentFormHandler.trackCommentEvent(t)},t.prototype.success=function(t){return this._rollUpCommentAndReplace(t,function(t){return function(e){var n;return n=$("<div>").addClass("comment_wrapper").html(e).hide(),t.ajaxCommentData.append(n),t.ajaxCommentData.animate({height:n.css("height")},800),n.slideDown(800,function(){return t.commentFormHandler.successPageReady()}),t.commentFormStore().clearSavedFormState()}}(this))},t.prototype.error=function(t){var e,n,o;return"1"===t.getResponseHeader("Regulations-Dot-Gov-Over-Rate-Limit")&&(o=this.commentFormHandler.commentFormLoadHandler.formWrapper().data("reggov-comment-url"),n="Over Rate Limit",e="<p> We were unable to successfully submit your comment at this time because Regulations.gov has received too many comments in the last hour. </p> <p> Please try submitting your comment again later, attempt to comment directly via Regulations.gov at <a href='"+o+"'>"+o+"</a>, or via any other method described in the document. </p>",FR2.Modal.displayModal(n,e)),this._rollUpCommentAndReplace(t,function(t){return function(e){var n;return n=$("<div>").addClass("comment_wrapper").html(e.responseText).hide(),t.ajaxCommentData.append(n),t.ajaxCommentData.animate({height:n.css("height")},800),n.slideDown(800,function(){return t.commentFormHandler.commentFormReady()})}}(this))},t.prototype._rollUpCommentAndReplace=function(t,e){var n;return this.ajaxCommentData=$(".ajax-comment-data"),n=this.ajaxCommentData.find(".comment_wrapper"),this.ajaxCommentData.animate({height:"42px"},400),$("#comment-bar.comment").scrollintoview({duration:400}),n.slideUp(400,function(){return n.remove(),e(t)})},t}()}.call(this),function(){this.FR2.CommentFormSuccessHandler=function(){function t(t){this.commentFormHandler=t}return t.prototype.initialize=function(){return this.add_events(),this.updateCommentHeader()},t.prototype.formWrapper=function(){return this.commentFormHandler.formWrapper},t.prototype.ajaxCommentData=function(){return $(".ajax-comment-data")},t.prototype.add_events=function(){return this.commentNotifications(),this.printComment(),this.analytics()},t.prototype.updateCommentHeader=function(){var t;return t=$("#comment-bar.comment p"),t.closest("div").removeClass("open"),t.html('You have successfully submitted an official comment to Regulations.gov. <img alt="Regulations.gov Logo" src="/assets/regulations_dot_gov_logo-6a990514f94ea77090a6b98aff8a2d1b186b384676acec9f82514109b187b05b.png" class="reg_gov_logo">')},t.prototype.commentNotifications=function(){return this.ajaxCommentData().on("click",".action.commit",function(t){return t.preventDefault(),$(this).closest("form").submit()}),this.ajaxCommentData().on("click",".comment_next_steps .my_fr a.notifications",function(t){var e;return t.preventDefault(),t.stopPropagation(),e=$(this),$.ajax({url:e.attr("href"),dataType:"json",type:e.data("method"),data:{comment_tracking_number:e.data("comment-tracking-number")},success:function(t){return e.html(t.link_text),e.data("method",t.method),e.closest("li").find(".description").html(t.description),e.toggleClass("remove")}})})},t.prototype.printComment=function(){return this.ajaxCommentData().on("click","a#print-comment",function(t){var e,n,o,r,i;return t.preventDefault(),i=$(this),r="Print your comment",o=$("#comment-print-summary-template"),e=i.data("comment-data"),n=Handlebars.compile(o.html())({fields:e,document_details:i.data("current-document-details"),comment_details:i.data("comment-details")}),FR2.Modal.displayModal(r,n,{modalClass:"print_modal"})}),$("body").on("modalClose",function(){return $("body").removeClass("invisible")}),$("body").on("click",".print_modal .print_button",function(t){return t.preventDefault(),$("body").addClass("invisible"),$("#fr_modal").addClass("visible"),window.print()})},t.prototype.trackCommentEvent=function(t){return this.commentFormHandler.trackCommentEvent(t)},t.prototype.analytics=function(){return this.ajaxCommentData().on("click",".tracking_number",function(t){return function(){return t.trackCommentEvent("Comment Success: Comment Tracking Number")}}(this)),this.ajaxCommentData().on("click",".my_fr .notifications.posting.remove",function(t){return function(){return t.trackCommentEvent("Comment Success: MyFR Posting Notification Opt Out")}}(this)),this.ajaxCommentData().on("click",".my_fr .notifications.posting",function(t){return function(){return t.trackCommentEvent("Comment Success: MyFR Posting Notification Opt In")}}(this)),this.ajaxCommentData().on("click",".my_fr .notifications.followup.remove",function(t){return function(){return t.trackCommentEvent("Comment Success: MyFR Posting Notification Opt Out")}}(this)),this.ajaxCommentData().on("click",".my_fr .notifications.followup",function(t){return function(){return t.trackCommentEvent("Comment Success: MyFR Posting Notification Opt In")}}(this)),this.ajaxCommentData().on("click","#print-comment",function(t){return function(){return t.trackCommentEvent("Comment Success: Print Comment")}}(this)),this.ajaxCommentData().on("click",".social_media .twitter",function(t){return function(){return t.trackCommentEvent("Comment Success: Social Media Twitter")}}(this)),this.ajaxCommentData().on("click",".social_media .facebook",function(t){return function(){return t.trackCommentEvent("Comment Success: Social Media Facebook")}}(this)),this.ajaxCommentData().on("click",".warning.message .resend_email_confirmation",function(t){return function(){return t.trackCommentEvent("Comment Success:  MyFR Resend Email Confirmation")}}(this)),this.ajaxCommentData().on("click",".actions .comment_form_sign_in",function(t){return function(){return t.trackCommentEvent("Comment Success:  MyFR Sign In")}}(this)),this.ajaxCommentData().on("click",".actions .comment_form_sign_up",function(t){return function(){return t.trackCommentEvent("Comment Success:  MyFR Sign Up")}}(this))},t}()}.call(this),function(){this.FR2.CommentingUnavailableHandler=function(){function t(t){this.formWrapper=t,this._bindClickListener()}return t.prototype._bindClickListener=function(){var t;return t=this,this.formWrapper.on("click","a#start_comment",function(e){var n;return e.preventDefault(),n=e.target.getAttribute("href"),FR2.Modal.displayModal("Direct Commenting Unavailable","<p>Submitting a formal comment directly via federalregister.gov is not available for this document.  "+t._optionalMessage()+"However, you can click the button below to view more information on alternate methods of comment submission.</p></br><a class='fr_button medium primary jqm-close-js'>View Additional Information</a>",{modalId:"#commentingUnavailableModal",alternateModalCloseSelector:".jqm-close-js",onHide:function(t){return t.w.hide(),t.o.remove(),$("html, body").stop().animate({scrollTop:$(n).offset().top},1500,function(){return window.location.hash=n}),$(n).next().addClass("highlight")}})})},t.prototype._optionalMessage=function(){return this._isParticipatingAgency()?"":"The agency does not participate in commenting via regulations.gov.  "},t.prototype._isParticipatingAgency=function(){return this.formWrapper.data("reg-gov-participating-agency")},t}()}.call(this),function(){$(document).ready(function(){var t;return t=$("a#start_comment[data-comment=1]").get(0),t||"#open-comment"===window.location.hash?FR2.commentFormHandlerInstance=new FR2.CommentFormHandler($("#comment-bar.comment")):new FR2.CommentingUnavailableHandler($("#comment-bar.comment"))})}.call(this),function(){}.call(this),function(){$(document).ready(function(){return $(".tooltip").tipsy({gravity:function(){return $(this).data("tooltip-gravity")||"s"},fade:!0,offset:0,title:function(){return $(this).data("tooltip")},className:function(){return $(this).data("tooltip-class")||""}}).mouseenter(function(){var t,e,n,o,r,i,a,s;return r=$(".tipsy").first(),t=$(this),o=15,i=r.height(),s=r.width(),a=r.position(),e=t.height(),n=t.offset(),r.css("left",n.left-s-o).css("top",n.top-i/2+e/4)})})}.call(this),function(){$(document).ready(function(){return $("#delete-folder").on("click",function(t){var e,n;return t.preventDefault(),e={numClippings:$("#clippings li").length,folderSlug:$("h2.title").data().folderSlug},n=Handlebars.compile($("#delete-folder-modal-template").html()),FR2.Modal.displayModal("",n(e),{includeTitle:!1,modalClass:"delete-folder-modal"}),$(".delete-folder-modal .delete-folder-modal-button").on("click",function(){return $(this).closest("form").submit()})})})}.call(this),$(document).ready(function(){$(".doc_notice.add_tipsy").tipsy({gravity:"e",fallback:"Notice",delayIn:100,fade:!0,offset:0}),$(".doc_rule.add_tipsy").tipsy({gravity:"e",fallback:"Final Rule",delayIn:100,fade:!0,offset:0}),$(".doc_proposed_rule.add_tipsy").tipsy({gravity:"e",fallback:"Proposed Rule",delayIn:100,fade:!0,offset:0}),$(".doc_presidential_document.add_tipsy").tipsy({gravity:"e",fallback:"Presidential Document",delayIn:100,fade:!0,offset:0}),$(".doc_unknown.add_tipsy").tipsy({gravity:"e",fallback:"Document of Unknown Type",delayIn:100,fade:!0,offset:0}),$(".doc_uncategorized.add_tipsy").tipsy({gravity:"e",fallback:"Uncategorized Document",delayIn:100,fade:!0,offset:0}),$(".doc_correct.add_tipsy").tipsy({gravity:"e",fallback:"Correction",delayIn:100,fade:!0,offset:0}),$(".fr-list .rule_type.with-tooltip-e").tipsy({gravity:"e",delayIn:100,fade:!0,offset:4,title:function(){return $(this).data("tooltip")}}),$(".fr-list .rule_type.with-tooltip-s").tipsy({gravity:"s",delayIn:100,fade:!0,offset:4,title:function(){return $(this).data("tooltip")}}),$(".fr-list .fr-link-stats li.with-tooltip").tipsy({gravity:"e",delayIn:100,fade:!0,offset:4,title:function(){return $(this).data("tooltip")}}),$(".fr-table .with-tooltip-s").tipsy({gravity:"s",delayIn:100,fade:!0,offset:4,title:function(){return $(this).data("tooltip")}}),$("#clippings li div.add_to_folder_pane").tipsy({gravity:"e",fallback:"Select clipping(s) and modify using menus above",fade:!0,offset:-15}),$("#clipping-actions #add-to-folder").tipsy({gravity:"s",fallback:"Select clipping(s) below to move them",fade:!0,offset:2}),$("#clipping-actions #remove-clipping").tipsy({gravity:"s",fallback:"Delete selected clipping(s)",fade:!0,offset:2}),$("#clipping-actions #doc-type-filter li:not(.disabled)").tipsy({gravity:"s",fade:!1,offset:2,title:function(){return $(this).data("tooltip")}}),$(".clipping_data .comment_on").tipsy({gravity:"s",fade:!0,offset:3,fallback:"You have officially commented on this document."}),$("#comments .comment_count").tipsy({gravity:"s",delayIn:500,fade:!0,offset:3,title:function(){return $(this).data("tooltip")}})}),function(){$(document).ready(function(){var t,e,n,o,r,i,a,s;return e=$.fn.tooltip.Constructor.DEFAULTS.whiteList,e.dl=[],e.dt=[],e.dd=[],e.dd=[],e.dd=[],e.span=["data-clipboard-text","data-tooltip"],$(".bootstrap-popover").popover({container:".bootstrap-scope",trigger:"manual"}),$("body").on("click",".copy-to-clipboard",function(t){var e;return t.preventDefault(),e=new FR2.Clipboard,e.copyToClipboard($(this).data("clipboardText")),$(".tipsy .tipsy-inner").text("Selection copied to clipboard")}),$(".doc-document .doc-content").length>0&&(FR2.PrintPageElements.setup(),FR2.UnprintedElements.setup(),o=$(".doc-document .doc-content").outerHeight(),i=$(".doc-aside.doc-details").outerHeight(),t=50,r=30,i+t>o&&$(".doc-content .fr-box").css("height",i+t+r),$(".bootstrap-popover").on("click",function(t){var e,n;return t.preventDefault(),n=$(this).data("tooltip-data")||{},$(this).hasClass("printed-page")&&(n.shortUrl=$("#fulltext_content_area").data("short-url"),$("#document-citation").data("citation-vol")&&(n.volume=$("#document-citation").data("citation-vol"))),e=$(this).data("bs.popover").tip().hasClass("in"),e?$(this).popover("hide"):($(this).data("bs.popover").options.content=Handlebars.compile($($(this).data("tooltip-template")).html())(n),$(this).popover("show"),CJ.Tooltip.addTooltip(".cj-tooltip",{offset:5,opacity:.9,delay:.3,fade:!0}))}),CJ.Tooltip.addFancyTooltip($(".document-markup.cj-fancy-tooltip"),{className:function(){var t;return t=$(this).data("tooltip-doc-override")?$(this).data("tooltip-doc-override"):$(".document-markup.cj-fancy-tooltip").parents(".doc-official").length>0?"tooltip-doc-official":"tooltip-doc-published","document-markup-tooltip "+t},delay:.3,fade:!0,gravity:"s",html:!0,opacity:1,title:function(){var t;return t=$(this).data("tooltip-data")||{},$(this).hasClass("printed-page")&&(t.shortUrl=$("#fulltext_content_area").data("short-url"),$("#document-citation").data("citation-vol")&&(t.volume=$("#document-citation").data("citation-vol"))),Handlebars.compile($($(this).data("tooltip-template")).html())(t)}},{position:"centerTop",horizontalOffset:-10,verticalOffset:-10}),$(".doc-content-area").delegate(".footnote .back","click",function(t){var e,n;return e=window.location.href.split("#")[1],n=$(this).closest("div.footnote").attr("id"),void 0!==e&&e===n?(t.preventDefault(),window.history.back()):void 0}),$(".doc-nav-wrapper a#display-unprinted-elements").on("click",function(t){return t.preventDefault(),FR2.DocumentTools.toggleNonPrintedElements($(this))}),$(".doc-nav-wrapper a#email-a-friend").on("click",function(t){var e;return t.preventDefault(),e=new FR2.EmailAFriend($(this).data("document-number")),e.display()}),n=$("#start_comment"),n.length>0&&!$("#comment-bar").data("reggov-comment-url")&&0===$("#addresses").length)?0===$("#further-info").length?(n.remove(),a=$("#utility-nav-formal-comment"),a.addClass("unavailable"),a.find(".fr-box.dropdown-menu").removeClass("fr-box-enhanced").addClass("disabled"),a.find("li").text("This feature is not available for this document."),s=$("#utility-nav-public-comments"),s.addClass("unavailable"),s.find(".fr-box.dropdown-menu").removeClass("fr-box-enhanced").addClass("disabled"),s.find("li").text("This feature is not available for this document.")):(n.attr("href","#further-info"),$("#utility-nav-comment-link").attr("href","#further-info")):void 0})}.call(this),function(){$(document).ready(function(){var t,e,n,o;return $(".doc-public-inspection .doc-content").length>0&&(e=$(".doc-public-inspection .doc-content").outerHeight(),o=$(".doc-aside.doc-details").outerHeight(),t=50,n=30,o+t>e)?$(".doc-content .fr-box").css("height",o+t+n):void 0})}.call(this),function(){$(document).ready(function(){return $("ul.doc-nav")&&($("ul.doc-nav > li").hover(function(){var t;return t=$(this),t.find(".dropdown-menu").stop(!0,!0).show(),t.addClass("open")},function(){var t;return t=$(this),t.find(".dropdown-menu").stop(!0,!0).hide(),t.removeClass("open")}),$("ul.doc-nav > li").click(function(t){return"A"!==t.toElement.tagName&&t.preventDefault(),$(t.target).hasClass("force-event-propagation")?void 0:t.stopPropagation()}),$(".doc-nav-wrapper").length>0)?$(".doc-document ul.doc-nav").sticky({context:".doc-content.with-utility-bar"}):void 0})}.call(this),function(){this.FR2.DocumentTools=function(){function t(){}return t.unprintedElementsDisplayed=!1,t.unprintedElementsSetup=!1,t.toggleNonPrintedElements=function(t){return this.toggleLinkText(t,this.unprintedElementsDisplayed),this.toggleElements($(".unprinted-element-wrapper").not(".printed-page-wrapper")),this.resetUtilityBarHeight(),this.unprintedElementsDisplayed=!this.unprintedElementsDisplayed},t.toggleLinkText=function(t,e){return t.text(e?t.text().replace(/^Hide/,"Display"):t.text().replace(/^Display/,"Hide"))},t.toggleElements=function(t){return this.unprintedElementsDisplayed?_.each(t,function(t){return $(t).hide()}):(_.each(t,function(t){return $(t).css("display","block")}),this.unprintedElementsSetup?void 0:(FR2.UnprintedElements.setup(),this.unprintedElementsSetup=!this.unprintedElementsSetup))},t.resetUtilityBarHeight=function(){var t;return t=$(".doc-nav-wrapper").siblings(".fr-box").first(),$(".doc-nav-wrapper").outerHeight(t.height()+"px"),$(".doc-document ul.doc-nav").sticky("refresh")},t}()}.call(this),function(){$(document).ready(function(){var t;return t="https://images."+window.location.hostname.replace("www.","")+"/missingimage",$("#fulltext_content_area").on("error","img.document-graphic-image",function(){var e;return e=$(this),e.attr("original-src",e.attr("src")),e.attr("src",t+"/large.png"),e.closest("a.document-graphic-link").attr("href",t+"/original.png")})})}.call(this),function(){$(document).ready(function(){var t,e;return $("#fulltext_content_area").length?(window.location.hash&&"#open-comment"!==window.location.hash&&"#addresses"!==window.location.hash&&(e=$(window.location.hash),t=$("<span>").addClass("icon-fr2 icon-fr2-link").data("tooltip","The url for this page contains a citation. This is the item that is cited."),e.append(t),CJ.Tooltip.addFancyTooltip(t,{className:"dynamic-citation-tooltip"},{horizontalOffset:-5,position:"centerTop",verticalOffset:-12})),new FR2.ParagraphCitation($("#fulltext_content_area"))):void 0})}.call(this),function(){this.FR2.HomeSectionPreviewManager=function(){function t(t){this.previewBox=$(t),this.attachBehavior(),this.carousels={},this.setUpCarousels(),this.selectRandomSection()}var e;return e=["money","environment","world","science-and-technology","business-and-industry","health-and-public-welfare"],t.prototype.selectRandomSection=function(){var t,n;return n=e[_.random(e.length-1)],t=$(".home-section-preview-nav li[data-section="+n+"]"),this.show_and_select(t)},t.prototype.attachBehavior=function(){var t,e;return e=this.previewBox.find(".home-section-preview-nav"),t=this,e.on("click","li",function(e){return e.preventDefault(),t.hide_all_and_deselect(),t.show_and_select($(this))})},t.prototype.show_and_select=function(t){var e;return t.addClass("selected"),e=$(t.data("toggle-target")),e.show(),_.each(e.find(".carousel-rounded-box"),function(t){return $(t).trigger("show")})},t.prototype.hide_all_and_deselect=function(){return _.each($(".home-section-preview-nav li"),function(t){return $(t).removeClass("selected")}),_.each($(".home-section-preview .home-section-preview-content"),function(t){return $(t).hide()})},t.prototype.setUpCarousels=function(){return _.each($(".carousel-home .carousel-wrapper"),function(t){return new FR2.CarouselScroller(t)})},t}()}.call(this),$(document).ready(function(){var t=null;$("#navigation .dropdown").bind("mouseenter",function(){var t=$(this);t.siblings().find(".dropdown").trigger("mouseleave"),t.find("a.top_nav").addClass("hover"),t.find(".subnav").show(),(t.hasClass("nav_sections")||t.hasClass("nav_browse")||t.hasClass("nav_blog"))&&setup_previewable_nav(t.find("a.top_nav"))}),$("#navigation .dropdown").bind("mouseleave",function(){$(this).find(".subnav").hide(),$(this).find("a.top_nav").removeClass("hover")}),$("#navigation .subnav .left_column a").bind("click",function(t){$(this).hasClass("hover")||t.preventDefault()}),$("#navigation .subnav").bind("mouseenter",function(){$(this).closest(".dropdown").find("a.top_nav").addClass("hover")}),$("#navigation .subnav").bind("mouseleave",function(){$(this).closest(".dropdown").find("a.top_nav").removeClass("hover"),$(this).hide(),$(document.elementFromPoint(event.clientX,event.clientY)).parent().hasClass("dropdown")&&$(document.elementFromPoint(event.clientX,event.clientY)).parent().trigger("mouseenter")}),$("#navigation .subnav .left_column li").bind("mouseenter",function(){var e=$(this);t=setTimeout(function(){e.closest(".left_column").find("li a").removeClass("hover"),e.find("a").addClass("hover"),$("#navigation .subnav .right_column li.preview").hide();var t=$("#navigation .subnav .right_column").find("#"+e.attr("id")+"-preview");t.show(),t.find(".carousel-rounded-box").trigger("show")},300)}),$("#navigation .subnav .left_column li").bind("mouseleave",function(){$(".ui-autocomplete.ui-menu").hide(),clearTimeout(t)}),$("#navigation .subnav .right_column li .calendar-wrapper ").bind("mouseenter",function(t){t.stopPropagation(),t.preventDefault()}),$("#navigation .previewable table.calendar").addClass("no_select"),$("#navigation .previewable table.cal_first").find(".cal_next").html(""),$("#navigation .previewable table.cal_last").find(".cal_prev").html(""),_.each($(".carousel-nav .carousel-wrapper"),function(t){new FR2.CarouselScroller(t)}),_.each($("#navigation form.facet-explorer-search"),function(t){new FR2.Autocompleter($(t))})}),function(){this.FR2.PrintPageElements=function(){function t(){}return t.docDetailsHeight=function(){return $(".doc-aside.doc-details").height()},t.printPageElements=function(){return $(".printed-page-wrapper")},t.printPageIcons=function(){return $(".printed-page-inline")},t.pageNumber=function(t){return t.find(".printed-page").data("page")},t.correspondingIcon=function(t){return $(".printed-page-inline[data-page="+t+"]")},t.correspondingGutterItem=function(t){return $(".printed-page-wrapper .printed-page[data-page="+t+"]").closest(".printed-page-wrapper")},t.setup=function(){return this.positionElements(),this.addUIEvents()},t.positionElements=function(){return this.blockElements(),this.alignGutterElements()},t.blockElements=function(){return _.each(this.printPageElements(),function(t){return function(e){var n,o;return e=$(e),o=e.parents("p").length>0?e.parents("p").position().top+e.position().top:e.position().top,o<t.docDetailsHeight()?(e.addClass("blocked"),n=t.correspondingIcon(t.pageNumber(e)),n.remove()):void 0}}(this))},t.alignGutterElements=function(){return _.each(this.printPageIcons(),function(t){return function(e){var n;return n=t.correspondingGutterItem($(e).data("page")),n.css("top",$(e).position().top-n.position().top)}}(this))},t.addUIEvents=function(){var t;return t=this,this.printPageElements().not(".blocked").on("mouseenter",function(e){return e.stopPropagation(),$(this).addClass("hover"),t.correspondingIcon(t.pageNumber($(this))).addClass("hover").addClass("icon-fr2-doc_filled").removeClass("icon-fr2-doc-generic")}),this.printPageElements().not(".blocked").on("mouseleave",function(){return $(this).removeClass("hover"),t.correspondingIcon(t.pageNumber($(this))).removeClass("hover").removeClass("icon-fr2-doc_filled").addClass("icon-fr2-doc-generic")}),this.printPageIcons().on("mouseenter",function(){var e;return $(this).addClass("hover").addClass("icon-fr2-doc_filled").removeClass("icon-fr2-doc-generic"),e=t.correspondingGutterItem($(this).data("page")),e.addClass("hover"),e.find(".printed-page").trigger("mouseenter"),e.find(".icon-fr2").addClass("icon-fr2-doc_filled").removeClass("icon-fr2-doc-generic")}),this.printPageIcons().on("mouseleave",function(){var e;return $(this).removeClass("hover").removeClass("icon-fr2-doc_filled").addClass("icon-fr2-doc-generic"),e=t.correspondingGutterItem($(this).data("page")),e.removeClass("hover"),e.find(".printed-page").trigger("mouseleave"),e.find(".icon-fr2").removeClass("icon-fr2-doc_filled").addClass("icon-fr2-doc-generic")})},t}()}.call(this),function(){this.FR2.UnprintedElements=function(){function t(){}return t.docDetailsHeight=function(){return $(".doc-aside.doc-details").height()},t.unprintedElements=function(){return $(".unprinted-element-wrapper").not(".printed-page-wrapper")},t.setup=function(){return this.positionElements()},t.positionElements=function(){return _.each(this.unprintedElements(),function(t){return function(e){return e=$(e),e.position().top<t.docDetailsHeight()?e.addClass("blocked"):void 0}}(this))},t}()}.call(this),fr_index_popover_handler={popover_cache:{},pi_base_url:"/api/v1/public-inspection-documents/",article_base_url:"/api/v1/documents/",current_el:null,article_fields:"fields%5B%5D=title&fields%5B%5D=document_number",uses_pi:!0,initialize:function(){return this},url:function(){return this.uses_pi?this.pi_base_url+this.current_el.data("document-number")+".json?"+this.fields:this.article_url()},article_url:function(){return this.article_base_url+this.current_el.data("document-number")+".json?"+this.article_fields},get_popover_content:function(t){var e=this;e.current_el=t,void 0===e.popover_cache[e.current_el.data("document-number")]?$.ajax({url:e.url(),dataType:"jsonp"}).done(function(t){if(e.uses_pi){var n=t;$.ajax({url:e.article_url(),dataType:"jsonp"}).done(function(t){n.title=t.title,n.document_number=t.document_number,e.ajax_done(n)})}else e.ajax_done(t)}):e.add_popover_content()},ajax_done:function(t){this.popover_cache[t.document_number]=t,this.current_el.data("document-number")===t.document_number&&this.add_popover_content()}},function(){this.FR2.TableModalHandler=function(){function t(t){this.expandTableLink=t,this.displayModal()}return t.prototype.displayModal=function(){var t,e;return e=$(this.expandTableLink).next().find(".original_table_container").clone(),e.find("thead").removeClass("invisible"),e.find("caption").removeClass("invisible"),t="<div class='modal-document-table-wrapper'><div class='fr-box-official'><div class='content-block doc-content-area'>"+e.html()+"</div></div>",FR2.Modal.displayModal("",t,{modalClass:"fr-modal document-table",includeTitle:!1}),this.changeModalOverlay()
},t.prototype.changeModalOverlay=function(){return $(".jqmOverlay").css({"z-index":3}),$(".jqmOverlay").css({"background-color":"rgb(255, 255, 255)"})},t}()}.call(this),fr_index_popover_handler.uses_pi=!1,fr_index_popover_handler.article_fields="fields%5B%5D=abstract&fields%5B%5D=comments_close_on&fields%5B%5D=significant&fields%5B%5D=regulations_dot_gov_info&fields%5B%5D=document_number",fr_index_popover_handler.add_popover_content=function(){var t=($(".tipsy"),this.current_el),e=Handlebars.compile($("#fr-index-entry-popover-content-template").html()),n="#popover-"+t.data("document-number"),o=e(this.popover_cache[t.data("document-number")]);$(n).find(".loading").replaceWith(o)},$(document).ready(function(){$("#fr-index-year-select select").on("change",function(){var t=$(this).val();window.location.href="/index/"+t});var t=fr_index_popover_handler.initialize();if($("#fr-index-entry-popover-template").length>0)var e=Handlebars.compile($("#fr-index-entry-popover-template").html());$(".doc-document-issue").delegate(".with-ajax-popover","mouseenter",function(){var n=$(this);n.tipsy({fade:!0,opacity:1,gravity:"n",html:!0,title:function(){return e({content:new Handlebars.SafeString('<div class="loading">Loading...</div>'),document_number:n.data("document-number"),title:n.data("document-title")})}}),n.tipsy("show"),$(".tipsy.tipsy-n").addClass("popover").css("left",n.find("dd.document_number").position().left),t.get_popover_content(n)}),$("a.toc_title").on("click",function(t){t.preventDefault(),$(this).siblings("div.index_entries").toggle()}),$("#indexes .entry_type").find(".comments_received, .comment_open, .significant").tipsy({fade:!0,opacity:.8,gravity:"s",title:function(){return $(this).data("tooltip")}}),$("#indexes.year .count_pill").tipsy({fade:!0,opacity:.8,gravity:"s",title:function(){return $(this).data("tooltip")}})}),function(){$(document).ready(function(){return CJ.Tooltip.addFancyTooltip($(".toc-document-metadata .cj-fancy-tooltip"),{className:"issue-doc-title-tooltip",delay:.3,fade:!0,gravity:"s",opacity:1},{position:"centerTop",verticalOffset:-14})})}.call(this),function(){$(document).ready(function(){var t,e;return $("#embedded_entry_search_form").length>0&&new FR2.EmbeddedSearch($("#embedded_entry_search_form")),$("#entry_search_form").length>0?(t=new FR2.SearchFormHandler($("#entry_search_form")),e=[new FR2.SearchTabCount($("#entry_search_form"),$(".tabs li.public-inspection"))]):$("#public_inspection_search_form").length>0&&(t=new FR2.SearchFormHandler($("#public_inspection_search_form")),e=[new FR2.SearchTabCount($("#public_inspection_search_form"),$(".tabs li.documents"))]),t?(t.calculateExpectedResults(),_.each(e,function(t){return t.getResultCount()})):void 0})}.call(this);